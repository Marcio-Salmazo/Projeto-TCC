(()=>{"use strict";function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.allSettled(e.map(function(e){return new Promise(function(n){var t=function(){return n()};if(!e)return t();var i=document.head.querySelector('link[href="'.concat(e,'"]'));if(i)return"complete"===i.readyState||"loaded"===i.readyState?t():(i.addEventListener("load",t),void i.addEventListener("error",t));var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),o.addEventListener("load",t),o.addEventListener("error",t),document.head.appendChild(o)})}))}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function t(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,o,a,s,r=[],l=!0,d=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=a.call(t)).done)&&(r.push(i.value),r.length!==n);l=!0);}catch(e){d=!0,o=e}finally{try{if(!l&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(d)throw o}}return r}}(e,n)||function(e,n){if(e){if("string"==typeof e)return i(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=Array(n);t<n;t++)i[t]=e[t];return i}function o(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,a(i.key),i)}}function a(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}window.amazonLoginScriptInjected=!1,window.openPassScriptInjected=!1,window.openPassClient=null;var s=function(){function n(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),this.onClosePopupCallback=e.onClosePopupCallback||function(){},this.onFinishedSignOnProcess=e.onFinishedSignOnProcess||function(){},this.valnetLoginAction=e.valnetLoginAction||null,this.mode=e.mode,this.idParent=e.idParent||null,this.className=e.className,this.triggeredFrom=e.triggeredFrom,this.gaEventCategory=e.gaEventCategory||null,this.showCloseButton=e.showCloseButton||!1,this.email=e.email||null,this.isUserExists=e.isUserExists||!1,this.sendSentinelLoginEvent=void 0===e.sendSentinelLoginEvent||e.sendSentinelLoginEvent,this.sendSentinelRegistrationEvent=void 0===e.sendSentinelRegistrationEvent||e.sendSentinelRegistrationEvent,this.googleRecaptchaInjected=!1,this.captchaManager=null,this.init()}return i=n,a=[{key:"init",value:function(){window.valnetLoginContent,this.valnetLoginAction&&this.valnetLoginAction.afterLogin?window.localStorage.setItem("valnetLoginAction",JSON.stringify(this.valnetLoginAction.afterLogin)):window.localStorage.removeItem("valnetLoginAction"),this.valnetLoginAction&&this.valnetLoginAction.apiCallCallback?(window.localStorage.setItem("apiCallCallback",this.valnetLoginAction.apiCallCallback),window.localStorage.setItem("apiCallCallbackOptions",JSON.stringify(this.valnetLoginAction.apiCallCallbackOptions))):(window.localStorage.removeItem("apiCallCallback"),window.localStorage.removeItem("apiCallCallbackOptions")),window.addEventListener("vn_ui:provider:loaded",function(e){e.detail&&e.detail.provider&&n.toggleButtonsVisibility(e.detail.provider)})}},{key:"defaultActiveTab",value:function(){return"email"}},{key:"onClickContinue",value:function(){var e=this,n=document.getElementById("continue-email-"+e.mode).value,t=document.getElementById("continue-form-error-msg-"+e.mode);if(t&&t.classList.add("is-hidden"),!n)return t.textContent="Email is required",void t.classList.remove("is-hidden");var i=encodeURIComponent(n),o=new XMLHttpRequest;o.open("GET","/check-user-exists/?email="+i+"&subscribe=true",!0),o.setRequestHeader("Content-mode","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var n=JSON.parse(o.response);if(n.error&&t)return t.textContent=n.error,void t.classList.remove("is-hidden");n.email&&(e.isUserExists=n.userExists,e.email=n.email,n.userExists?(e.setContainerActiveTab("login",!1),hideDisclaimers()):(e.setContainerActiveTab("register",!1),showDisclaimers()))}},o.send()}},{key:"onClickLogin",value:function(){var e=this,n=(new URLSearchParams(window.location.search).get("displayMode"),document.getElementById("login-email-"+e.mode).value),i=document.getElementById("login-password-"+e.mode).value,o=document.getElementById("login-form-error-msg-"+e.mode);if(o&&o.classList.add("is-hidden"),!n||!i)return o.innerText="Email and password are required",void o.classList.remove("is-hidden");var a={email:n,password:i};if(a){var s=new XMLHttpRequest;s.open("POST","/login/",!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var r=new URLSearchParams,l=0,d=Object.entries(a);l<d.length;l++){var c=t(d[l],2),u=c[0],g=c[1];r.append(u,g)}s.onreadystatechange=function(){if(4==s.readyState){var n=JSON.parse(s.response);if(n.error&&o)return o.innerText=n.error,void o.classList.remove("is-hidden");n.user&&(e.sendGaEvent(e.gaEventCategory,"login",window.location.pathname),e.sendWebsiteSentinelEvent(window.getLoginFormEventCategoryOpening(),"login","email"),e.fireFinishedSignonProcess(),e.handleAfterLogin.call(e,[]),window.resetLoginFormEventCategoryOpening())}},s.send(r.toString())}}},{key:"handleAfterLogin",value:function(){console.log("reload handleAfterLogin");var e=this.valnetLoginAction;e||(e={apiCallCallback:window.localStorage.getItem("apiCallCallback"),apiCallCallbackOptions:window.localStorage.getItem("apiCallCallbackOptions")}),window.handleValnetAfterLoginCall(e,!0)}},{key:"onClickCreateAccount",value:function(){var e=document.getElementById("register-form-error-msg-"+this.mode),n=document.getElementById("register-email-"+this.mode).value,t=document.getElementById("register-password-"+this.mode).value;if(e&&e.classList.add("is-hidden"),!n||!t)return e.innerText="Email and password are required",void e.classList.remove("is-hidden");this.verifyRecaptcha()}},{key:"verifyRecaptcha",value:function(){this.captchaManager&&this.captchaManager.verifyAndSubmit()}},{key:"onClickRegister",value:function(){var e=this,n=document.getElementById("register-email-"+e.mode).value,t=document.getElementById("register-password-"+e.mode).value;if(n&&t){var i="/register/";"newsletter"==e.triggeredFrom&&(i="/newsletter-register/");var o=new XMLHttpRequest;o.open("POST",i,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=new URLSearchParams;a.append("email",n),a.append("password",t),o.onreadystatechange=function(){if(4==o.readyState){var n=JSON.parse(o.response);if(n.error){var t=document.getElementById("register-form-error-msg-"+e.mode);return void(t&&(t.textContent=n.error,t.classList.remove("is-hidden")))}e.handleOnSuccessRegister(n)}},o.send(a.toString())}}},{key:"fireFinishedSignonProcess",value:function(){try{this.onFinishedSignOnProcess()}catch(e){}}},{key:"handleOnSuccessLogin",value:function(e){this.sendGaEvent(this.gaEventCategory,"login",window.location.pathname),console.log("%cSending Sentinel Event: %Login","color: white; background-color: #007bff; padding: 2px 4px; border-radius: 2px;","color: #007bff; background-color: #e9ecef; padding: 2px 4px; border-radius: 2px;"),this.sendWebsiteSentinelLoginEvent(),this.fireFinishedSignonProcess()}},{key:"handleOnSuccessRegister",value:function(e){this.sendGaEvent(this.gaEventCategory,"registration",window.location.pathname),console.log("%cSending Sentinel Event: %cRegister","color: white; background-color: #007bff; padding: 2px 4px; border-radius: 2px;","color: #007bff; background-color: #e9ecef; padding: 2px 4px; border-radius: 2px;"),this.sendWebsiteSentinelRegistrationEvent();var n=this.backgroundLoginActions();n&&(window.callbackUrl=n),this.fireFinishedSignonProcess();var t=!1;window.location.hostname&&window.location.hostname.includes("military")&&(t=!0),t&&"function"==typeof window.showMilitaryProfilePopup?window.showMilitaryProfilePopup(null,this.mode):"newsletter"==this.triggeredFrom?window.showNewsletterPreferencesPopup(null,!0,this.mode,!0):window.showNewsletterPreferencesPopup(null,null,this.mode,!0)}},{key:"injectLoginForm",value:function(){var n,t,i=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=document.getElementById(this.idParent);if(!document.getElementById("valnet-login-container-"+this.mode)){if(window.showArticleBlockerLoginOverlay)var s=window.valnetArticleBlockerLoginContent.trim("&quot;");else s=window.valnetLoginContent.trim("&quot;");s=(s=(s=(s=(s=(s=(s=(s=s.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#39;/g,"'")).replace(/&amp;/g,"&")).replace(/(^"|"$)/g,"")).replaceAll(/id="([^"]*)/g,function(e,n){return e+"-"+i.mode})).replaceAll(/class="w-login([^"]*)/g,function(e,n){return e+"-"+i.className});var r=(n=s,(t=document.createElement("template")).innerHTML=n,Array.from(t.content.childNodes).find(function(e){return e.nodeType!==Node.TEXT_NODE}));r.setAttribute("hidden",!0),function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e([n]).then(function(){t()})}(r.getAttribute("data-style-path-url"),function(){r.removeAttribute("hidden")}),a?a.appendChild(r):document.body.appendChild(r),this.setupAllButtons(o)}}},{key:"setupAllButtons",value:function(e){this.injectGoogleLoginScript(e),this.injectGoogleRecaptcha(),this.addEventListeners(),this.addCloseButton(),this.setUpAmazonLogin(),this.setUpOpenPassLogin(),this.setUpTwitchLogin(),this.setUpSteamLogin(),"continue"==this.defaultActiveTab()&&document.getElementById("goback-button-continue-"+this.mode).classList.remove("is-hidden"),this.setUpFacebookLogin(e),this.setUpAppleLogin(e),this.setContainerActiveTab(this.defaultActiveTab(),!0),"function"==typeof window.handleDiscordLogin&&n.toggleButtonsVisibility("discord")}},{key:"injectLinkingForm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.setUpFacebookLogin(e),this.setUpAppleLogin(e)}},{key:"showLoginForm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0!==e&&void 0!==e.gaEventCategory&&console.log("%cEvent Category: %c"+e.gaEventCategory,"color: white; background-color: blue; font-weight: bold; padding: 2px 4px; border-radius: 3px;","color: black; background-color: lightyellow; font-weight: bold; padding: 2px 4px; border-radius: 3px;"),"articlelimiter"!=this.mode?this.injectLoginForm(e):this.setupAllButtons(e),"popup"==this.mode){var n=this;setTimeout(function(){document.addEventListener("click",function(e){n.addClosePopupOnDocumentClick.call(n,e)},!0)},500)}"newsletter"==this.triggeredFrom&&this.setContainerActiveTab("register",!1),this.saveInSession("loginFormEventCategoryOpening",this.gaEventCategory);var t=document.getElementById("valnet-login-container-"+this.mode);t&&t.classList.add("is-visible")}},{key:"setContainerActiveTab",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var t=document.querySelectorAll(["#intro-container-"+this.mode,"#openPass-container-"+this.mode,"#signin-with-email-button-"+this.mode,"#login-container-"+this.mode,"#continue-container-"+this.mode,"#register-container-"+this.mode,"#other-options-container-"+this.mode]);if(t.length>0){t.forEach(function(n){n.id.includes(e)?n.classList.remove("is-hidden"):n.classList.add("is-hidden")}),this.updateEmailFields(e),this.resetErrorMessages();var i=document.getElementById("login-title-"+this.mode);if(i&&(i.textContent="register"==e?"Create an Account":"login"==e?"Log In":"Log in or Create an Account"),"openPass"==e||"email"==e||"continue"==e){var o=document.getElementById("intro-container-"+this.mode);o&&o.classList.remove("is-hidden")}n&&document.getElementById("other-options-container-"+this.mode).classList.remove("is-hidden"),"continue"!=e&&"email"!=e||window.showDisclaimers(),"openPass"==e&&window.hideDisclaimers()}}}},{key:"updateEmailFields",value:function(e){var n=this;if(e){var t=document.querySelectorAll('[id*="-email-'+this.mode+'"]');t.length>0&&t.forEach(function(t){t.id.includes(e)?t.value=n.email:t.value=""})}}},{key:"resetErrorMessages",value:function(){var e=document.querySelectorAll('[id*="-form-error-msg-'+this.mode+'"]');e.length>0&&e.forEach(function(e){e.classList.add("is-hidden")});var n=document.getElementById("login-main-error-msg-"+this.mode);n&&n.classList.add("is-hidden")}},{key:"addEventListeners",value:function(){var e=document.getElementById("continue-button-"+this.mode);e&&e.addEventListener("click",this.onClickContinue.bind(this));var n=document.getElementById("login-button-"+this.mode);n&&n.addEventListener("click",this.onClickLogin.bind(this));var t=document.getElementById("register-button-"+this.mode);t&&t.addEventListener("click",this.onClickCreateAccount.bind(this));var i=document.getElementById("signin-with-openpass-button-"+this.mode);i&&i.addEventListener("click",this.setContainerActiveTab.bind(this,"openPass",!1));var o=document.getElementById("signin-with-email-button-"+this.mode);o&&o.addEventListener("click",this.setContainerActiveTab.bind(this,"continue",!1));var a=document.getElementById("goback-button-login-"+this.mode);a&&a.addEventListener("click",this.setContainerActiveTab.bind(this,"continue",!1));var s=document.getElementById("goback-button-register-"+this.mode);s&&s.addEventListener("click",this.setContainerActiveTab.bind(this,"continue",!1));var r=document.getElementById("goback-button-continue-"+this.mode);r&&r.addEventListener("click",this.setContainerActiveTab.bind(this,"email",!0));var l=document.getElementById("goback-button-openPass-"+this.mode);l&&l.addEventListener("click",this.setContainerActiveTab.bind(this,"email",!0))}},{key:"addCloseButton",value:function(){if(this.showCloseButton){var e=this,n=document.getElementById("closeLoginPopupButton-"+e.mode);n&&(n.classList.remove("is-hidden"),n.addEventListener("click",function(n){n.preventDefault();var t=document.getElementById("valnet-login-container-"+e.mode),i=t.querySelector("#platform-email-creation-container-"+e.mode);i&&i.classList.add("is-hidden");var o=t.querySelector("#login-title-"+e.mode);if(o&&o.classList.contains("is-hidden")&&o.classList.remove("is-hidden"),"articlelimiter"!=e.mode){if(t.classList.remove("is-visible"),e.setContainerActiveTab(e.defaultActiveTab(),!0),e.onClosePopupCallback)try{e.onClosePopupCallback()}catch(e){console.error(e)}}else t.remove()}))}}},{key:"addClosePopupOnDocumentClick",value:function(e){var n=document.getElementById("valnet-login-container-"+this.mode),t=n.firstChild;if(t.contains(e.target)||e.target===t||!n.classList.contains("is-visible"));else if(n.classList.remove("is-visible"),this.setContainerActiveTab(this.defaultActiveTab(),!0),n.contains(e.target)&&this.onClosePopupCallback)try{this.onClosePopupCallback()}catch(e){console.error(e)}}},{key:"sendGaEvent",value:function(e,n,t){e&&n&&t&&(ga("send","event",{eventCategory:e,eventAction:n,eventLabel:t}),gtag("event",e,{event_action:n,event_label:t}))}},{key:"resetStickyAdsOnDrawerVisible",value:function(){document.querySelectorAll(".ad-zone-floating").forEach(function(e){return e.remove()}),document.querySelectorAll(".adhesion_wrapper").forEach(function(e){return e.remove()});var e=document.querySelector(".w-adsninja-video-player.featured-video.js-sticky-featured-video");e&&e.classList.remove("js-sticky-featured-video")}},{key:"injectGoogleRecaptcha",value:function(){var e=this;this.googleRecaptchaInjected||(this.captchaManager=new window.CaptchaManager({v3Config:{siteKey:window.v3RecaptchaSiteKey,action:"login"},v2Config:{siteKey:window.recaptchaSiteKey,containerId:"v2-captcha-container-"+this.mode},autoSubmit:!1,submitCallback:this.onClickRegister.bind(this),handleResponse:function(n,t){var i=document.getElementById("register-form-error-msg-"+e.mode);i&&(i.innerText=t,i.classList.remove("is-hidden"))}}),this.googleRecaptchaInjected=!0)}},{key:"injectGoogleLoginScript",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(window.googleLoginScriptInjected)window.initGoogleLogin(e),n.toggleButtonsVisibility("google");else{var t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",document.body.append(t),t.onload=function(){window.initGoogleLogin(e),n.toggleButtonsVisibility("google")}}}},{key:"saveInSession",value:function(e,n){e&&n&&sessionStorage.setItem(e,n)}},{key:"getFromSession",value:function(e){if(e)return sessionStorage.getItem(e)}},{key:"setUpAmazonLogin",value:function(){window.amazonClientId&&(window.amazonLoginScriptInjected||this.injectAmazonLogin())}},{key:"injectAmazonLogin",value:function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.id="amazon-login-sdk",e.src="https://assets.loginwithamazon.com/sdk/na/login1.js",document.getElementById("amazon-root").appendChild(e),e.onload=function(){n.toggleButtonsVisibility("amazon"),window.amazonLoginScriptInjected=!0}}},{key:"setUpOpenPassLogin",value:function(){if(window.openPassClientId){var e=this;if(window.openPassScriptInjected)e.injectOpenPassFrame();else{var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.mode="openpass-login-sdk",n.src="https://cdn.myopenpass.com/openpass-js-sdk/v4/openpass-js-sdk.min.js",document.head.appendChild(n),n.onload=function(){window.openPassScriptInjected=!0,window.openPassClient=new openpass.OpenPassClient({clientId:window.openPassClientId}),e.injectOpenPassFrame()}}}}},{key:"setUpTwitchLogin",value:function(){window.twitchClientId&&n.toggleButtonsVisibility("twitch")}},{key:"setUpSteamLogin",value:function(){window.isSteamEnabled&&n.toggleButtonsVisibility("steam")}},{key:"injectOpenPassFrame",value:function(){var e=this,n="#000000",t=!1;window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(t=!0,n="#ffffff");var i=document.getElementById("openPass-sign-in-"+this.mode);if(i&&0==i.children.length){var o={parentContainerElementId:"openPass-sign-in-"+this.mode,authenticationMode:"popup",hideSignInFormApplicationLogo:!0,hideSignInFormHeaderText:!0,signinButtonTextOption:"continue",signinButtonBackgroundColorHex:n,darkModeEnabled:t,signinButtonBorderRadiusInPixels:4,popupSuccessCallback:function(n){e.handleOpenPassLoginResponse(n.idToken.email,n.rawIdToken)},popupFailedCallback:function(e){window.location="/login"}};window.openPassClient.renderInlineSignInForm(o)}}},{key:"handleOpenPassLoginResponse",value:function(e,n){if(e){var t=this,i=new XMLHttpRequest;i.open("POST","/openpass-login/",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=JSON.parse(i.response);e.success&&(t.sendGaEvent(t.getFromSession("loginFormEventCategoryOpening"),e.isUserExists?"login":"registration",window.location.pathname),console.log("%c Sending Sentinel OpenPass: %c".concat(e.isUserExists?"Login":"Registration"),"color: white; background-color: #007bff; padding: 2px 4px; border-radius: 2px;","color: #007bff; background-color: #e9ecef; padding: 2px 4px; border-radius: 2px;"),t.sendWebsiteSentinelEvent(t.getFromSession("loginFormEventCategoryOpening"),e.isUserExists?"login":"registration","openpass"),t.fireFinishedSignonProcess(),e.isUserExists?"/page/newsletter/"==location.pathname?window.location.href="/profile/":t.handleAfterLogin.call(t,[]):window.showNewsletterPreferencesPopup(null,null,t.mode))}},i.send("email="+encodeURIComponent(e)+"&rawIdToken="+encodeURIComponent(n))}}},{key:"sendWebsiteSentinelLoginEvent",value:function(){if(this.sendSentinelLoginEvent&&window.websiteSentinel){var e=this.gaEventCategory||"login";window.websiteSentinel.sendEvent(e,"login","")}}},{key:"sendWebsiteSentinelRegistrationEvent",value:function(){if(this.sendSentinelRegistrationEvent&&window.websiteSentinel){var e=this.gaEventCategory||"registration";window.websiteSentinel.sendEvent(e,"registration","")}}},{key:"sendWebsiteSentinelEvent",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";window.websiteSentinel&&window.websiteSentinel.sendEvent(e,n,t)}},{key:"setUpFacebookLogin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;window.facebookClientId&&(this.injectFacebookSDK(window.facebookClientId),e&&(window.valnetLoginInstance=e))}},{key:"injectFacebookSDK",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"v18.0",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(window.facebookSDKInjected)FB.init({appId:e,cookie:!0,xfbml:!0,version:t}),FB.AppEvents.logPageView(),i&&"function"==typeof i&&i(),n.toggleButtonsVisibility("facebook");else{window.fbAsyncInit=function(){FB.init({appId:e,cookie:!0,xfbml:!0,version:t}),FB.AppEvents.logPageView(),i&&"function"==typeof i&&i()};var o=document.createElement("script");o.src="https://connect.facebook.net/en_US/sdk.js",o.id="facebook-jssdk";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a),n.toggleButtonsVisibility("facebook"),window.facebookSDKInjected=!0}}},{key:"backgroundLoginActions",value:function(){var e=window.location.hostname;if(e.includes("fextralife")){console.log("It is loading here");var n=new XMLHttpRequest,t=new Date;t.setTime(t.getTime()+31536e6),e.includes("qa")&&e.includes(".fextralife.com")?(n.open("GET","https://eldenring.qa3.fextralife.com/ws/page/checkbis?bg="+Date.now(),!0),document.cookie="fxchck=fxlogged; expires="+t.toUTCString()+"; path=/; domain=.qa3.fextralife.com",console.log("**ONE")):e.includes("fextralife.com.")||e.includes("fextralife.dev")?(n.open("GET","https://eldenring.wiki.fextralife.dev/ws/page/checkbis?bg="+Date.now(),!0),document.cookie="fxchck=fxlogged; expires="+t.toUTCString()+"; path=/; domain=.fextralife.dev",console.log("**TWO")):(n.open("GET","https://eldenring.wiki.fextralife.com/ws/page/checkbis?bg="+Date.now(),!0),document.cookie="fxchck=fxlogged; expires="+t.toUTCString()+"; path=/; domain=.fextralife.com",console.log("**THREE")),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.withCredentials=!0;var i=new URLSearchParams(window.location.search).get("loginRedirect");if(null!=i){var o=new URL(i.replace(/ /g,"+"));return"/wiki"!=o.pathname.substring(0,5)&&"/ws"!=o.pathname.substring(0,3)?redirectUrl=o.origin+"/ws/page/check"+o.pathname+"?ts="+Date.now():redirectUrl=o.origin+o.pathname+"?ts="+Date.now(),redirectUrl}}return window.self!==window.top&&(console.log("It is here!!"),window.parent.postMessage("loginSuccess","*")),null}},{key:"setUpAppleLogin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;window.appleClientId&&(this.injectAppleSDK(window.appleClientId),e&&(window.valnetLoginInstance=e))}},{key:"injectAppleSDK",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.origin+"/",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"name email",o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(window.appleSDKInjected)AppleID.auth.init({clientId:e,scope:i,redirectURI:t,usePopup:o}),n.toggleButtonsVisibility("apple");else{var a=document.createElement("script");a.src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js",a.id="apple-id-sdk",a.onload=function(){AppleID.auth.init({clientId:e,scope:i,redirectURI:t,usePopup:o}),n.toggleButtonsVisibility("apple")};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(a,s),window.appleSDKInjected=!0}}}],s=[{key:"toggleButtonsVisibility",value:function(e){document.querySelectorAll(".custom-button--item.affiliate.".concat(e)).forEach(function(e){e.style.visibility="visible"})}},{key:"showPlatformEmailCreationForm",value:function(e){var n=document.getElementById(e);n&&(this.getAllSiblings(n,"div").forEach(function(e){e.classList.add("is-hidden")}),this.getAllSiblings(n,"p").forEach(function(e){"disclaimer-block-popup"!=e.id&&"disclaimer-block-static"!=e.id||(e.style.display="block")}),n.classList.remove("is-hidden"))}},{key:"getAllSiblings",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return Array.from(e.parentNode.children).filter(function(t){return t!==e&&t.tagName.toLowerCase()===n.toLowerCase()})}}],a&&o(i.prototype,a),s&&o(i,s),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,a,s}();document.addEventListener("AppleIDSignInOnSuccess",function(e){thisObj=void 0;var n=new XMLHttpRequest;n.open("POST","/apple-login/",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.onreadystatechange=function(e){if(4==n.readyState&&200==n.status){var t=JSON.parse(n.response);t.success&&(window.getLoginFormEventCategoryOpening()&&(window.valnetLoginInstance.sendGaEvent(window.getLoginFormEventCategoryOpening(),t.isUserExists?"login":"registration",window.location.pathname),console.log("%c Sending Sentinel OpenPass: %c".concat(t.isUserExists?"Login":"Registration"),"color: white; background-color: #007bff; padding: 2px 4px; border-radius: 2px;","color: #007bff; background-color: #e9ecef; padding: 2px 4px; border-radius: 2px;"),window.valnetLoginInstance.sendWebsiteSentinelEvent(window.getLoginFormEventCategoryOpening(),t.isUserExists?"login":"registration","apple"),window.resetLoginFormEventCategoryOpening()),this.fireFinishedSignonProcess(),t.isUserExists?"/page/newsletter/"==location.pathname?window.location.href="/profile/":window.valnetLoginInstance.handleAfterLogin.call(window.valnetLoginInstance,[]):window.showNewsletterPreferencesPopup(null,null,window.valnetLoginInstance.mode))}else window.hidePopups()},n.send("id_token="+e.detail.authorization.id_token),console.log(e.detail.authorization.id_token)}),document.addEventListener("AppleIDSignInOnFailure",function(e){window.hidePopups()}),window.hideDisclaimers=function(){var e=document.querySelectorAll('[data-disclaimer-location="main"]');0!==e.length&&e.forEach(function(e){return e.style.display="none"})},window.showDisclaimers=function(){var e=document.querySelectorAll('[data-disclaimer-location="main"]');0!==e.length&&e.forEach(function(e){return e.style.display="block"})},window.ValnetLogin=s})();