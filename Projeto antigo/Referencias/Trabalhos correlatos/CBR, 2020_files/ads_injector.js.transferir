/*! For license information please see ads_injector.js.LICENSE.txt */
window.adsNinja=window.adsNinja||{},window.adsNinja.queue=window.adsNinja.queue||[],window.adsNinja.storageManager={get:function(e){if(!e||"string"!=typeof e)throw new Error("Invalid key.");return window.localStorage.getItem(e)},getWithExpiry:function(e){var t=this.get(e);if(!t)return null;var n=JSON.parse(t);return(new Date).getTime()>n.expiry?(this.remove(e),null):n.value},set:function(e,t){if(!e||!t||"string"!=typeof e||"string"!=typeof t)throw new Error("Invalid key or value.");window.localStorage.setItem(e,t)},setWithExpiry:function(e,t,n){var i={value:t,expiry:(new Date).getTime()+n};this.set(e,JSON.stringify(i))},remove:function(e){window.localStorage.removeItem(e)},clear:function(){window.localStorage.clear()},getKeys:function(){return Object.keys(window.localStorage)},increment:function(e){var t=this.get(e);return t=t?parseInt(t)+1:1,this.set(e,t.toString()),t},incrementWithExpiry:function(e,t){var n=this.getWithExpiry(e);return n=n?parseInt(n)+1:1,this.setWithExpiry(e,n.toString(),t),n},decrement:function(e){var t=this.get(e);return t=t?parseInt(t)-1:1,this.set(e,t.toString()),t},decrementWithExpiry:function(e,t){var n=this.getWithExpiry(e);return n=n?parseInt(n)-1:1,this.setWithExpiry(e,n.toString(),t),n}},window.ads_injector=new class{configs={};adSetup=null;API_params={};validation_errors=[];adsData=[];customHeaders={};source=null;customHeaders={};repeatablePlacementIndex=[];repeatableAdCountAdded=[];repeatableAdRepeatIndex=[];remainingCharacterCount=[];characterCountRules={};noRepeatableAdsInsideQueryString="";noRepeatableAdsAfterQueryString="";boostedUrlData=null;gamId=null;noInjectionRules={};overwrite_changes=[];euTraffic={AT:"Austria",BE:"Belgium",BG:"Bulgaria",HR:"Croatia",CY:"Republic of Cyprus",CZ:"Czech Republic",DK:"Denmark",EE:"Estonia",FI:"Finland",FR:"France",DE:"Germany",GR:"Greece",HU:"Hungary",IS:"Iceland",IE:"Ireland",IT:"Italy",LV:"Latvia",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MT:"Malta",NL:"Netherlands",NO:"Norway",PL:"Poland",PT:"Portugal",RO:"Romania",SK:"Slovakia",SI:"Slovenia",ES:"Spain",SE:"Sweden",GB:"United Kingdom"};regionsToIncludeCMP={AT:{country:"Austria",states:{},consentContext:"gdpr",consentNeeded:!0},BE:{country:"Belgium",states:{},consentContext:"gdpr",consentNeeded:!0},BG:{country:"Bulgaria",states:{},consentContext:"gdpr",consentNeeded:!0},HR:{country:"Croatia",states:{},consentContext:"gdpr",consentNeeded:!0},CY:{country:"Republic of Cyprus",states:{},consentContext:"gdpr",consentNeeded:!0},CZ:{country:"Czech Republic",states:{},consentContext:"gdpr",consentNeeded:!0},DK:{country:"Denmark",states:{},consentContext:"gdpr",consentNeeded:!0},EE:{country:"Estonia",states:{},consentContext:"gdpr",consentNeeded:!0},FI:{country:"Finland",states:{},consentContext:"gdpr",consentNeeded:!0},FR:{country:"France",states:{},consentContext:"gdpr",consentNeeded:!0},DE:{country:"Germany",states:{},consentContext:"gdpr",consentNeeded:!0},GR:{country:"Greece",states:{},consentContext:"gdpr",consentNeeded:!0},HU:{country:"Hungary",states:{},consentContext:"gdpr",consentNeeded:!0},IS:{country:"Iceland",states:{},consentContext:"gdpr",consentNeeded:!0},IE:{country:"Ireland",states:{},consentContext:"gdpr",consentNeeded:!0},IT:{country:"Italy",states:{},consentContext:"gdpr",consentNeeded:!0},LV:{country:"Latvia",states:{},consentContext:"gdpr",consentNeeded:!0},LI:{country:"Liechtenstein",states:{},consentContext:"gdpr",consentNeeded:!0},LT:{country:"Lithuania",states:{},consentContext:"gdpr",consentNeeded:!0},LU:{country:"Luxembourg",states:{},consentContext:"gdpr",consentNeeded:!0},MT:{country:"Malta",states:{},consentContext:"gdpr",consentNeeded:!0},NL:{country:"Netherlands",states:{},consentContext:"gdpr",consentNeeded:!0},NO:{country:"Norway",states:{},consentContext:"gdpr",consentNeeded:!0},PL:{country:"Poland",states:{},consentContext:"gdpr",consentNeeded:!0},PT:{country:"Portugal",states:{},consentContext:"gdpr",consentNeeded:!0},RO:{country:"Romania",states:{},consentContext:"gdpr",consentNeeded:!0},SK:{country:"Slovakia",states:{},consentContext:"gdpr",consentNeeded:!0},SI:{country:"Slovenia",states:{},consentContext:"gdpr",consentNeeded:!0},ES:{country:"Spain",states:{},consentContext:"gdpr",consentNeeded:!0},SE:{country:"Sweden",states:{},consentContext:"gdpr",consentNeeded:!0},GB:{country:"United Kingdom",states:{},consentContext:"gdpr",consentNeeded:!0},US:{country:"United States",states:{CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",IN:"Indiana",IA:"Iowa",KY:"Kentucky",MD:"Maryland",MT:"Montana",MN:"Minnesota",NE:"Nebraska",NH:"New Hampshire",NJ:"New Jersey",OR:"Oregon",RI:"Rhode Island",TN:"Tennessee",TX:"Texas",UT:"Utah",VA:"Virginia"},consentContext:"gpp",consentNeeded:!1}};pageview=1;constructor(e){this.configs=e}setConfigs=function(e){this.configs=e};setCountry=function(e){this.country=e};setRegion=function(e){this.region=e};setCity=function(e){this.city=e};setGAMId=function(e){this.gamId=e};setBoostedUrlData=function(e){e&&(this.boostedUrlData={isBoosted:e})};__getZones=function(){return this.configs.zones};__getAPIParams=function(){return this.API_params};init=async function(){this.__waitForDOMReady().then(async()=>{if(this.pageview=window.adsNinja.storageManager.incrementWithExpiry("pageview",12e5),await this.__setConfigs(),await this.__setAdSetup(),this.source=this.__determineSource(),null!==this.adSetup){this.__setNoRepeatableAdsQueryStrings(),this.__generateAPIParams();let e=this.__getAPIParams().data.deviceType;e&&document.body.classList.add(`an-device-${e}`),await this.__fetchAdsConfigs(),await this.__handleOverwriteConfig(),await this.__handleMappedZones(),await this.__generateScripts(),await this.__generatePageLevelTargeting(),await this.__generateZones(),this.__initAdsNinja()}else console.warn("ADS INJECTOR --- No ads injected")})};__setConfigs=async function(){if("string"==typeof this.configs&&await this.__fetchConfigs(this.configs),!this.__validateConfig())return console.error("Config validation failed"),void(this.validation_errors&&this.validation_errors.forEach(e=>console.error(e)))};__setNoRepeatableAdsQueryStrings=function(){let e="",t="";void 0!==this.configs.no_repeatable_ads_containers&&this.configs.no_repeatable_ads_containers.forEach(n=>{switch(t="",n.element_type){case"tag":case"query":t=n.element;break;case"class":t="."+n.element;break;case"id":t="#"+n.element}this.__isQuerySelectorValid(t)?e+=t+", ":console.warn("ADS INJECTOR: no_repeatable_ads_containers selector '"+n.element+"' is invalid.")}),this.noRepeatableAdsInsideQueryString=e.substring(0,e.length-2),e="",void 0!==this.configs.no_repeatable_ads_after&&this.configs.no_repeatable_ads_after.forEach(n=>{switch(t="",n.element_type){case"tag":case"query":t=n.element;break;case"class":t="."+n.element;break;case"id":t="#"+n.element}this.__isQuerySelectorValid(t)?e+=t+", ":console.warn("ADS INJECTOR: no_repeatable_ads_after selector '"+n.element+"' is invalid.")}),this.noRepeatableAdsAfterQueryString=e.substring(0,e.length-2)};__fetchConfigs=async function(e){await fetch(e).then(e=>e.json()).then(e=>{this.configs=e}).catch(e=>{console.error("Error reading the JSON file:",e)})};__ajax=async function(e){return await fetch(e,{method:"GET",timeout:1e3}).then(e=>{if(!e.ok)throw new Error("Failed to fetch. Status: "+e.status);return e.json()}).then(e=>e).catch(e=>{console.error(e)})};__fetchAdsConfigs=async function(){var e="adsninja.ca",t=document.getElementById("an-injector");t&&(e=t.src,e=(e=new URL(e)).host),this.adsConfigs=await this.__ajax("https://"+e+"/api/cached/v2/by_adsetup_infos_json/clientData/get/?"+this.__httpBuildQuery(this.__getAPIParams())),console.log("ADS INJECTOR --- API URL: ","https://"+e+"/api/cached/v2/by_adsetup_infos_json/clientData/get/?"+this.__httpBuildQuery(this.__getAPIParams())),console.log("ADS INJECTOR --- RECEIVED DATA FROM API: ",this.adsConfigs),this.__validateAdsConfigs()};__handleOverwriteConfig=async function(){this.configs.overwrite&&(this.configs.overwrite.forEach((e,t)=>{e.hasOwnProperty("criteria")?e.criteria.forEach(t=>{if(console.log("ADS INJECTOR: Overwrite Criteria: ",t),void 0!==t.days){let e=[],n=(new Date).getDay();if(console.log("ADS INJECTOR: Day: ",n),"string"==typeof t.days){let n=t.days.split("-"),i=n[0],a=n[1];e=[];for(let t=parseInt(i);t<=a;t++)e.push(t)}else e=t.days;if(console.log("ADS INJECTOR: Days: ",e),-1===e.indexOf(n))return void console.log("ADS INJECTOR: Day criteria not met")}if(void 0!==t.hours){let e=[],n=(new Date).getHours();if(console.log("ADS INJECTOR: Hour : ",n),"string"==typeof t.hours){let n=t.hours.split("-"),i=n[0],a=n[1];e=[];for(let t=parseInt(i);t<=a;t++)e.push(t)}else e=t.hours;if(console.log("ADS INJECTOR: hours: ",e),-1===e.indexOf(n))return void console.log("ADS INJECTOR: Hour criteria not met")}let n=!0;void 0!==t.urls&&(console.log("ADS INJECTOR: URL: ",window.location.pathname),n=!1,t.urls.forEach(e=>{if(console.log("ADS INJECTOR: Criteria URL: ",e),-1!==window.location.pathname.indexOf(e))return console.log("ADS INJECTOR: URL criteria met"),void(n=!0)}));let i=!0;void 0!==t.elements&&(console.log("ADS INJECTOR: Elements Selectors: ",t.elements),i=!1,t.elements.forEach(e=>{if(console.log("ADS INJECTOR: Criteria CSS Selector: ",e),this.__isQuerySelectorValid(e)&&(e=document.querySelector(e),console.log("ADS INJECTOR: Element: ",e),null!==e))return console.log("ADS INJECTOR: CSS Selector criteria met"),void(i=!0)}));let a=!0;if(void 0!==t.dateRange){a=!1,console.log("ADS INJECTOR: Date Range: ",t.dateRange);let e=new Date,n=new Date(t.dateRange.start+" 00:00:00"),i=new Date(t.dateRange.end+" 00:00:00");console.log("ADS INJECTOR: Now: ",e),console.log("ADS INJECTOR: Start Date: ",n),console.log("ADS INJECTOR: End Date: ",i),e>=n&&e<=i&&(console.log("ADS INJECTOR: Date Range criteria met"),a=!0)}console.log("ADS INJECTOR: Element passed: ",i),console.log("ADS INJECTOR: URL passed: ",n),console.log("ADS INJECTOR: Date Range passed: ",a),i&&n&&a&&(console.log("ADS INJECTOR: Criteria met changes will be applied",e.changes),this.overwrite_changes={...this.overwrite_changes,...e.changes})}):(console.log("ADS INJECTOR: No criteria. Changes will be applied",e.changes),this.overwrite_changes={...this.overwrite_changes,...e.changes})}),console.log("ADS INJECTOR: Overwrite changes: ",this.overwrite_changes))};__validateAdsConfigs=function(){this.adsConfigs?this.adsConfigs.logData.chosenAdSetup||(console.warn("ADS INJECTOR --- API couldn't find match a valid ad setup"),this.adsConfigs=null):console.warn("ADS INJECTOR --- No data received from the API")};__generateAPIParams=function(){this.API_params={...this.configs.api_parameters,data:{url:"/",brandName:this.configs.api_parameters.brandName,modeAds:1,template:this.adSetup.template,networkCategory:this.adSetup.networkCategory||"all",contentType:this.adSetup.contentType||"all",deviceType:this.__isMobile()?"mobile":"desktop",source:this.source?this.source:null,geo:this.country||"all",extraParams:this.__getExtraParams()}}};__getExtraParams=function(){let e={};return window.isPremiumUser?e={websiteUserLogin:"premium"}:window.isUserLoggedIn&&(e={websiteUserLogin:"free"}),e};__isMobile=function(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(e=>navigator.userAgent.match(e))};__getLiveHost=function(e){let t=e,n=e.split(".");return"www"===n[0]||"ads"!=n[0]&&!/^qa\d+$/.test(n[0])||(t=t.replace(n[0],"www")),n.length>3&&(t=t.replace("."+n[3],"")),t};__setAdSetup=async function(){if(this?.configs?.ad_setup){if(this.configs?.ad_setup?.no_ads.urls){let e=!1;if(Object.entries(this.configs?.ad_setup?.no_ads.urls).every(([t,n])=>(-1!==window.location.href.indexOf(n)&&(e=!0),!e)),e)return void(this.adSetup=null)}if(!(this.configs?.ad_setup.by_urls&&(Object.entries(this.configs.ad_setup.by_urls).every(([e,t])=>(Object.entries(t.urls).every(([e,n])=>(-1!==window.location.href.indexOf(n)&&(this.adSetup=t.setup),!this.adSetup)),!this.adSetup)),this.adSetup)||this.configs?.ad_setup.by_elements&&(Object.entries(this.configs.ad_setup.by_elements).every(([e,t])=>(Object.entries(t.elements).every(([e,n])=>(this.__isQuerySelectorValid(n.toString())?document.querySelectorAll(n.toString()).length>0&&(this.adSetup=t.setup):console.warn('ADS INJECTOR --- Ad Setup by element  "'+n.toString()+'" is invalid.'),!this.adSetup)),!this.adSetup)),this.adSetup))){var e=window.location.pathname;e=e.replace(/\/$/,""),["","/","/index","/home","/index.html","/home.html","/index.php","/home.php","/index.asp","/home.asp"].includes(e)?this.adSetup=this?.configs?.ad_setup.homepage:this.adSetup=this?.configs?.ad_setup.default}}else console.warn("Cannot find template in the config")};__getContainerFromConfigByZoneName=function(e){let t=!1;return this.adSetup?.zones?.forEach(n=>{n.name!==e||(t=n.container)}),!1===t&&this.configs?.zones?.forEach(n=>{n.name!==e||(t=n.container)}),t};__handleMappedZones=async function(){this.adsConfigs&&Object.entries(this.adsConfigs.ads).forEach(([e,t])=>{let n=this.__getContainerFromConfigByZoneName(t.zone.name);!1!==n?null===t.zone.parent?(t.zone.children&&t.zone.children.length>0&&(t.zone.realChildren=[],t.zone.children.forEach(e=>{Object.entries(this.adsConfigs.ads).forEach(([n,i])=>{i.zone.name===e.name&&(Object.entries(i.zone.zoneDisplayType).forEach(([e,n])=>{t.idAdsSetup.toString()===e&&(i.zone.displayType=n)}),Object.entries(i.zone.zonePositionType).forEach(([e,n])=>{t.idAdsSetup.toString()===e&&(i.zone.positionType=n)}),t.zone.realChildren.push(i))})})),t.container=n,this.adsData.push(t)):console.warn("ADS INJECTOR --- Child zone shouldn't be mapped in the configs. \""+t.zone.name+'" is a child of "'+t.zone.parent.name+'"'):(t.hasOwnProperty("zone")&&t.zone.hasOwnProperty("isFrontEndInjectable")&&t.zone.isFrontEndInjectable||t.hasOwnProperty("videoOptions")&&t.videoOptions&&Object.keys(t.videoOptions).length>0)&&this.adsData.push(t),n||null!==t.zone.parent||console.warn('ADS INJECTOR --- Zone "'+t.zone.name+'" is not mapped in the configs')})};__generateScripts=async function(){if(!this.adsConfigs)return;let e=document.createElement("script");e.src="https://imasdk.googleapis.com/js/sdkloader/ima3.js",e.async=!1,document.head.appendChild(e);var t="cdn.adsninja.ca",n=this.adsConfigs.environment;n="production"===n.toLowerCase()?"live":n;var i=document.getElementById("an-injector");i&&(t=i.src,"cdn.adsninja.ca"!==(t=(t=new URL(t)).host)&&(t+="/cached"));for(let e in this.adsConfigs.bidderTypeHeaders){let i=document.createElement("script");i.src="https://"+t+"/biddertypelibrary/"+n+"/"+this.adsConfigs.siteConfig.brand.name+"/"+this.adsConfigs.bidderTypeHeaders[e].name+".js?v="+this.adsConfigs.jsVersion,i.async=!1,document.body.append(i)}let a=document.createElement("script");a.src="https://"+t+"/adsninja_client.js?v="+this.adsConfigs.jsVersion,a.async=!1,document.body.appendChild(a);for(let e in this.adsConfigs.adTypeHeaders){let t=this.adsConfigs.adTypeHeaders[e].header;this.__addContentToHead(t);let n=this.adsConfigs.adTypeHeaders[e].headerBottom;this.__addContentToHead(n);let i=this.adsConfigs.adTypeHeaders[e].customHeaders||{};this.customHeaders=Object.assign({},this.customHeaders,i);for(let t in i)this.__getAdsData().forEach(n=>{if(n.hasOwnProperty("zone")&&n.zone.hasOwnProperty("isFrontEndInjectable")&&n.zone.isFrontEndInjectable)return!0;if("outstream"!==t.toLowerCase()&&"header"!==t.toLowerCase()&&n.hasOwnProperty("videoOptions")&&n.videoOptions&&Object.keys(n.videoOptions).length>0)return!0;if(t.toLowerCase()===n.zone.name.toLowerCase()){if(!this.__getZoneElement(n.container)&&""!==this.adsConfigs.adTypeHeaders[e].customHeaders[t].header)return;let i=this.adsConfigs.adTypeHeaders[e].customHeaders[t].header;this.__addContentToHead(i)}})}let o=document.createElement("link");o.href="https://"+t+"/adsninja_client_style.css?v="+this.adsConfigs.jsVersion,o.rel="stylesheet",document.head.appendChild(o);for(let e in this.adsConfigs.templateTypeDependencies)for(let t in this.adsConfigs.templateTypeDependencies[e])for(let n in this.adsConfigs.templateTypeDependencies[e][t])if("Non-AMP"===n||"CMP"===n&&this.__shouldIncludeCmp()){let i=this.adsConfigs.templateTypeDependencies[e][t][n];switch(e){case"headers":case"styles":this.__addContentToHead(i);break;case"footers":this.__addContentToFooter(i)}}};__generatePageLevelTargeting=async function(){if(!this.adsConfigs)return;let e="0";void 0!==window.isUserLoggedIn&&window.isUserLoggedIn&&(e="1");let t="\n            \x3c!-- Page-Level Targeting --\x3e          \n            <script>\n                var googletag = googletag || {};\n                googletag.cmd = googletag.cmd || [];\n                \n                googletag.cmd.push(function() {\n                    googletag.pubads()\n                    .setTargeting('Site', ['"+this.adsConfigs.siteConfig.brand.name+"']) \n                    .setTargeting('ContentType', ['"+(this.adSetup.contentType||"")+"'])\n                    .setTargeting('Template', ['"+(this.adSetup.template||"")+"'])\n                    .setTargeting('NetworkCategory', ['"+("undefined"!=typeof VALNET_GLOBAL_NETWORKCATEGORY?VALNET_GLOBAL_NETWORKCATEGORY:"")+"'])\n                    .setTargeting('SiteCategory', ['"+(this.adSetup.siteCategory||"")+"'])\n                    .setTargeting('PostID', ['"+("undefined"!=typeof VALNET_GLOBAL_POSTID?VALNET_GLOBAL_POSTID:"")+"'])\n                    .setTargeting('Source', ['"+(this.source||"")+"'])\n                    .setTargeting('Intent', ['"+(this.adSetup.intent||"")+"'])\n                    .setTargeting('Segment', ['"+(this.adSetup.segment||"")+"'])\n                    .setTargeting('LoggedIn', ['"+e+"']);            \n                 });\n            <\/script>\n            \x3c!-- Page-Level Targeting --\x3e\n        ";null!==this.gamId&&(t=t+"\n            \x3c!-- pageUrl identifier --\x3e\n            <script>\n                googletag.cmd.push(function(){\n                   googletag.pubads().setTargeting('pageUrlIdentifier', ['"+this.gamId+"']); \n                });\n            <\/script>\n            "),null!=this.boostedUrlData&&"object"==typeof this.boostedUrlData&&Object.keys(this.boostedUrlData).includes("isBoosted")&&"1"===this.boostedUrlData.isBoosted&&(t=t+"\n            \x3c!-- pageUrl identifier --\x3e\n            <script>\n                googletag.cmd.push(function(){\n                   googletag.pubads().setTargeting('isBoosted', ['"+this.__runABTestboostOnThisPageLoad()+"']); \n                });\n            <\/script>\n            "),this.__addContentToHead(t)};__runABTestboostOnThisPageLoad=function(){let e=0,t=this.__getHighValueAdBehaviourValue("articleBoostPercentage");return null!==t&&(Math.floor(100*Math.random())+1<=t?(e=1,this.boostedUrlData.boostNow=1):(e=0,this.boostedUrlData.boostNow=0)),e};__getHighValueAdBehaviourValue=function(e){if(!Object.keys(this.adsConfigs).includes("adBehaviours")||"object"!=typeof this.adsConfigs.adBehaviours||null==this.adsConfigs.adBehaviours)return null;let t=this.adsConfigs.adBehaviours.highValueSegmentOptions??null,n=(this.adsConfigs.adBehaviours.parent??null).highValueSegmentOptions??null;return null!==t&&null!==t[e]?t[e]:null!==n&&null!==n[e]?n[e]:null};__setAdDimensions=function(e){var t="auto",n="auto";if(null!==e.customDimensions)void 0!==(i=e.customDimensions.split("x"))[0]&&""!==i[0]&&(t=i[0].includes("%")?i[0]:`${i[0]}px`),void 0!==i[1]&&""!==i[1]&&(n=i[1].includes("%")?i[1]:`${i[1]}px`);else if(null!==e.dimension&&"no_size"!==e.dimension.dimension){var i;t=`${(i=e.dimension.dimension.split("x"))[0]}px`,n=`${i[1]}px`}return e.width=t,e.height=n,e};__generateZones=async function(){if(!this.adsConfigs)return;let e=[];this.adsData=this.__getAdsData().filter(t=>{if((t=this.__setAdDimensions(t)).hasOwnProperty("zone")&&t.zone.hasOwnProperty("isFrontEndInjectable")&&t.zone.isFrontEndInjectable)return!0;if(!t.hasOwnProperty("container")&&t.hasOwnProperty("videoOptions")&&t.videoOptions&&Object.keys(t.videoOptions).length>0)return!0;if(!1===t.container?.print)return!0;let n=this.__getZoneElement(t.container);if(!n)return console.warn("ADS INJECTOR --- Element not found for zone: "+t.zone.name),!1;if(t.zone.pageLimit&&"object"==typeof t.zone.pageLimit)switch(t.zone.pageLimit.idQualifier){case 1:if(this.pageview!==t.zone.pageLimit.resourceNumber)return!1;break;case 2:if(this.pageview<t.zone.pageLimit.resourceNumber)return!1;break;case 3:if(this.pageview%t.zone.pageLimit.resourceNumber>0)return!1}if(t.zone.isRepeatable){let i=this.adsConfigs.repeatableAdZones[t.zone.name].repeatableRule;this.overwrite_changes.hasOwnProperty("startingPoint")&&(i.startingPoint=this.overwrite_changes.startingPoint),this.overwrite_changes.hasOwnProperty("degradationStartingPoint")&&(i.degradationStartingPoint=this.overwrite_changes.degradationStartingPoint),this.overwrite_changes.hasOwnProperty("degradationStartingPointPlus")&&(i.degradationStartingPointPlus=this.overwrite_changes.degradationStartingPointPlus),this.repeatableAdCountAdded[t.zone.name]=0,this.repeatablePlacementIndex[t.zone.name]=0,this.repeatableAdRepeatIndex[t.zone.name]=0;let a="afterend";switch(i.type){case"basic":console.log("ADS INJECTOR --- Repeatable zone :",t.zone.name),a="before"==i.placement?"beforebegin":"afterend";let o="";if("custom"===i.htmlTag.toLowerCase()){let e=i?.customOpenHtmlTag.match(/class="([^"]+)"/);console.log("ADS INJECTOR --- ClassName :",e),e?o="."+e[1].replace(/\s+/g,"."):console.warn("ADS INJECTOR --- Couldnt find classNames :",o)}else o="image block"===i.htmlTag.toLowerCase()?"img":i.htmlTag.replace("<","").replace(">","");console.log("ADS INJECTOR --- Selector :",o);let s=n.querySelectorAll(o);console.log("ADS INJECTOR --- Elements :",s);let r=1;for(let n=0;n<s.length;n++)this.repeatablePlacementIndex[t.zone.name]===i.degradationStartingPoint&&(r=i.degradationEntityCount),null!==i.degradationEntityCountPlus&&this.repeatablePlacementIndex[t.zone.name]===i.degradationStartingPointPlus&&(r=i.degradationEntityCountPlus),this.repeatablePlacementIndex[t.zone.name]+=1,void 0!==t.container?.clsFriendly&&t.container?.clsFriendly||!this.__isElementWillBeAboveOrInViewport(s[n],a)?(this.repeatablePlacementIndex[t.zone.name]===i.startingPoint||(this.repeatablePlacementIndex[t.zone.name]-i.startingPoint)%r===0)&&e.push(this.__printRepeatableAd(t,s[n],i,a)):console.warn("ADS INJECTOR --- "+t.zone.name+" not printed because of CLS verification",s[n]);break;case"characterCount":this.remainingCharacterCount[t.zone.name]=0,e=this.__handleCharacterCountRepeatableZone(n,t,i,a,!0);break;default:console.warn("ADS INJECTOR --- Repeatable zone : "+t.zone.name+' has a rule of type  "'+i.type+'" and is not implemented yet')}}else{let e="";if(e=t.container.inside?t.container.before?"afterbegin":"beforeend":t.container.before?"beforebegin":"afterend",(void 0===t.container?.clsFriendly||!t.container?.clsFriendly)&&this.__isElementWillBeAboveOrInViewport(n,e))return console.warn("ADS INJECTOR --- "+t.zone.name+" not printed because of CLS verification",n),!1;let i=this.__generateHtmlByZone(t.zone.name);i&&this.__possibleToAddAd(n,e)&&n.insertAdjacentHTML(e,i)}return!0}),this.overwrite_changes.hasOwnProperty("css")&&this.overwrite_changes.css.forEach(e=>{let t=document.querySelectorAll(e.selector);e.style.forEach(e=>{t.forEach(t=>{t.style[e.property]=e.value})})}),e.forEach(e=>{null!==e&&e&&this.adsData.push(e)})};__handleCharacterCountRepeatableZone(e,t,n,i,a=!1){let o=[],s=this.__getRepeatableCharacterCountNodes(e),r=n.characterCount;this.overwrite_changes.hasOwnProperty("characterCount")&&(r=this.overwrite_changes.characterCount),this.overwrite_changes.hasOwnProperty("degradationCharacterCount")&&(n.degradationCharacterCount=this.overwrite_changes.degradationCharacterCount),this.overwrite_changes.hasOwnProperty("degradationStartingPoint")&&(n.degradationStartingPoint=this.overwrite_changes.degradationStartingPoint),this.overwrite_changes.hasOwnProperty("degradationCharacterCountPlus")&&(n.degradationCharacterCountPlus=this.overwrite_changes.degradationCharacterCountPlus),this.overwrite_changes.hasOwnProperty("degradationStartingPointPlus")&&(n.degradationStartingPointPlus=this.overwrite_changes.degradationStartingPointPlus);let d=!1;for(let e=0;e<s.length;e++){let a=null;null!==n.degradationCharacterCount&&null!==n.degradationStartingPoint&&this.repeatablePlacementIndex[t.zone.name]>=n.degradationStartingPoint&&(r=n.degradationCharacterCount),null!==n.degradationCharacterCountPlus&&null!==n.degradationStartingPointPlus&&this.repeatablePlacementIndex[t.zone.name]>=n.degradationStartingPointPlus&&(r=n.degradationCharacterCountPlus);let l=null;if(this.characterCountRules.hasOwnProperty("#"+s[e].id.toLowerCase())&&(l="#"+s[e].id.toLowerCase()),null===l){if("FX"===this.adsConfigs.siteConfig.brand.shortName){let t=s[e].className.toLowerCase();t=t.replace(/\s+$/,""),t=t.replace(/ /g,"."),t="."+t,this.characterCountRules.hasOwnProperty(t)&&(l=t)}if(null===l){let t=s[e].className.toLowerCase().split(" ");for(let e=0;e<t.length;e++)if(this.characterCountRules.hasOwnProperty("."+t[e])){l="."+t[e];break}}}null===l&&this.characterCountRules.hasOwnProperty(s[e].nodeName.toLowerCase())&&(l=s[e].nodeName.toLowerCase());let c={nodeCharacterCount:a,tryEarlyInjection:d,triedEarlyInjection:!1,limitCharacterCount:r,remainingCharacterCount:this.remainingCharacterCount[t.zone.name]};if(s[e].insertAdjacentHTML("beforebegin",`\x3c!-- Before Debug Info: ${JSON.stringify(c)}.--\x3e`),l)if(this.characterCountRules[l].hasOwnProperty("count"))a=this.characterCountRules[l].count;else if(this.characterCountRules[l].hasOwnProperty("count_by_child")&&this.characterCountRules[l].hasOwnProperty("child")){let t=this.characterCountRules[l].count_by_child;a=s[e].querySelectorAll(this.characterCountRules[l].child).length*t}null===a&&(a=s[e].textContent.replace(/\s+/g," ").length);let h=r-this.remainingCharacterCount[t.zone.name];d&&2*h<=a?(void 0!==t.container?.clsFriendly&&t.container?.clsFriendly?o.push(this.__printRepeatableAd(t,s[e],n,"beforebegin")):this.__isElementWillBeAboveOrInViewport(s[e],"beforebegin")?console.warn("ADS INJECTOR --- "+t.zone.name+" not printed because of CLS verification",s[e]):o.push(this.__printRepeatableAd(t,s[e],n,"beforebegin")),this.repeatablePlacementIndex[t.zone.name]+=1,this.remainingCharacterCount[t.zone.name]=a-h,d=!1,c={nodeCharacterCount:a,tryEarlyInjection:d,triedEarlyInjection:!0,limitCharacterCount:r,remainingCharacterCount:this.remainingCharacterCount[t.zone.name]},s[e].insertAdjacentHTML("afterend",`\x3c!-- After Debug Info: ${JSON.stringify(c)}.--\x3e`)):(a+this.remainingCharacterCount[t.zone.name]>r?(void 0!==t.container?.clsFriendly&&t.container?.clsFriendly?o.push(this.__printRepeatableAd(t,s[e],n,i)):this.__isElementWillBeAboveOrInViewport(s[e],i)?console.warn("ADS INJECTOR --- "+t.zone.name+" not printed because of CLS verification",s[e]):o.push(this.__printRepeatableAd(t,s[e],n,i)),this.repeatablePlacementIndex[t.zone.name]+=1,this.remainingCharacterCount[t.zone.name]=0,d=!1):(this.remainingCharacterCount[t.zone.name]+=a,d=this.remainingCharacterCount[t.zone.name]>.65*r),c={nodeCharacterCount:a,tryEarlyInjection:d,triedEarlyInjection:!1,limitCharacterCount:r,remainingCharacterCount:this.remainingCharacterCount[t.zone.name]},s[e].insertAdjacentHTML("afterend",`\x3c!-- After Debug Info: ${JSON.stringify(c)}.--\x3e`))}return a&&t.container.hasOwnProperty("afterRepeatableThreshold")&&this.remainingCharacterCount[t.zone.name]>r*t.container.afterRepeatableThreshold&&(void 0!==t.container?.clsFriendly&&t.container?.clsFriendly?o.push(this.__printRepeatableAd(t,e,n,"beforeend")):this.__isElementWillBeAboveOrInViewport(e,"beforeend")?console.warn("ADS INJECTOR --- "+t.zone.name+" not printed because of CLS verification",e):o.push(this.__printRepeatableAd(t,e,n,"beforeend"))),o}generateRepeatableZones=function(e,t){if(!e)return;let n=[],i=!1;return this.__getAdsData().some(a=>{if(!1===a.zone.isRepeatable)return!1;if(a.zone.name===t&&!a.zone.isFrontEndInjectable){i=!0;let t=this.adsConfigs.repeatableAdZones[a.zone.name].repeatableRule,o="afterend";switch(t.type){case"basic":break;case"characterCount":n=this.__handleCharacterCountRepeatableZone(e,a,t,o,!1)}}if(i&&n.length>0){let e=`injector_${Date.now()}`,t=[];n.forEach(function(n){let i=window.adsNinjaHeaderBiddingManager.__createAndAddNewAdData(n);i.auctionId=e,t.push(i)});var o=window.adsNinjaHeaderBiddingManager.setupAuctionRepeatable(t,e);return!!o&&(window.adsNinjaHeaderBiddingManager.setupDynamicallyInjectionRefreshAdZones(o.getGamAdSlots(),window.adsNinjaHeaderBiddingManager.__refreshData),window.adsNinjaHeaderBiddingManager.requestHeaderBids(o.getId()),window.adsNinjaHeaderBiddingManager.startFailSafeTimeout(o.getId()),!0)}}),n};__isElementWillBeAboveOrInViewport=function(e,t){let n=e.getBoundingClientRect();switch(t){case"beforebegin":case"afterbegin":return n.top<=window.innerHeight&&n.bottom>=0||n.top<0;case"beforeend":case"afterend":return n.bottom<=window.innerHeight}};__getRepeatableCharacterCountNodes=function(e){this.characterCountRules={};let t=[];if(this.configs.character_count_rules&&(this.configs.character_count_rules.forEach(e=>{if(e.identifier&&this.__isQuerySelectorValid(e.identifier)){let n=e.identifier.toLowerCase();document.querySelector(n),this.characterCountRules[n]=e,t.push(n)}else console.warn('ADS INJECTOR --- character_count_rules "'+e.identifier+'" is not a valid identifier')}),t.length>0)){let n=[];return e.querySelectorAll(t.join(", ")).forEach(e=>{let i=!1;t.forEach(t=>{this.__hasParent(e,t)&&(i=!0)}),i||n.push(e)}),n}return!1};__hasParent(e,t){return null!==e.parentElement&&(!!e.parentElement.matches(t)||this.__hasParent(e.parentElement,t))}__isQuerySelectorValid=function(e){try{return document.querySelector(e),!0}catch(e){return!1}};__getNextRepeatableAd=function(e){if(!e.zone||!e.zone.realChildren)return e;let t=null;return e.zone.realChildren.forEach(n=>{1!==n.zone.positionType||n.zone.position!==this.repeatableAdCountAdded[e.zone.name]||(t=n)}),null===t&&e.zone.realChildren.forEach(n=>{2!==n.zone.positionType||this.repeatableAdCountAdded[e.zone.name]%n.zone.position!==0||(t=n)}),null===t&&(t=e),t};__possibleToAddAd=function(e,t){if(!this.configs.no_injection_rules)return!0;let n=[],i=null,a=[];if("afterbegin"==t||"beforeend"==t)this.configs.no_injection_rules.inside&&(n=this.configs.no_injection_rules.inside);else if("beforebegin"==t){if(this.configs.no_injection_rules.before&&(n=this.configs.no_injection_rules.before),this.configs.no_injection_rules.after&&(a=this.configs.no_injection_rules.after,i=e.previousSibling,null!==i))for(;(i.nodeType==Node.COMMENT_NODE||i.nodeType==Node.TEXT_NODE)&&(i=i.previousSibling,null!==i););}else if("afterend"==t&&(this.configs.no_injection_rules.after&&(n=this.configs.no_injection_rules.after),this.configs.no_injection_rules.before&&(a=this.configs.no_injection_rules.before,i=e.nextSibling,null!==i)))for(;(i.nodeType==Node.COMMENT_NODE||i.nodeType==Node.TEXT_NODE)&&(i=i.nextSibling,null!==i););let o=!0;return n.forEach(n=>{this.__isQuerySelectorValid(n)&&document.querySelectorAll(n).forEach(i=>{i===e&&(console.log("No injection rule "+t+" : "+n,e),o=!1)})}),null!==i&&o&&a.forEach(n=>{this.__isQuerySelectorValid(n)&&document.querySelectorAll(n).forEach(a=>{a===i&&(console.log("No injection rule "+t+" : "+n,e),o=!1)})}),o&&this.configs.no_injection_rules.inside&&this.configs.no_injection_rules.inside.forEach(n=>{if(this.__hasParent(e,n))return console.log("No injection rule "+t+" : "+n,e),o=!1,!1}),o};__printRepeatableAd=function(e,t,n,i){let a=!i.includes("before"),o=this.__getPrintableNode(t,a);if(null===o)return null;if(!this.__possibleToAddAd(o,i))return null;let s=null;if(s=a?o.nextElementSibling:o.previousElementSibling,s&&s.classList.contains("an-injector-zone"))return null;if(!o.classList.contains("adsninja-injected-repeatable-ad-"+i)&&(this.overwrite_changes.hasOwnProperty("startingPoint")&&(n.startingPoint=this.overwrite_changes.startingPoint),this.overwrite_changes.hasOwnProperty("skipEvery")&&(n.skipEvery=this.overwrite_changes.skipEvery),this.overwrite_changes.hasOwnProperty("stopAds")&&(n.stopAds=this.overwrite_changes.stopAds),this.repeatablePlacementIndex[e.zone.name]>=n.startingPoint)){if(this.repeatableAdCountAdded[e.zone.name]+=1,null!==n.skipEvery&&this.repeatableAdCountAdded[e.zone.name]%(n.skipEvery+1)===0||null!==n.stopAds&&this.repeatableAdCountAdded[e.zone.name]>=n.stopAds+1)return;let t=this.__getNextRepeatableAd(e);if(!t)return;let a=this.__generateHtmlByZone(t.zone.name);if(!a)return;let s=this.__getZoneHeaders(t.zone.name),m=t.divId,_=document.createElement("script");void 0===this.repeatableAdRepeatIndex[t.zone.name]&&(this.repeatableAdRepeatIndex[t.zone.name]=0),1!==t.zone.positionType?(0!==this.repeatableAdRepeatIndex[t.zone.name]&&(m=t.divId+"-REPEAT"+this.repeatableAdRepeatIndex[t.zone.name],_.innerHTML=s.replace(new RegExp(t.divId,"g"),m),a=a.replace(new RegExp(t.divId,"g"),m),document.head.appendChild(_)),this.repeatableAdRepeatIndex[t.zone.name]++):(_.innerHTML=s,document.head.appendChild(_));let C=document.createElement("div");C.innerHTML=a;let y=C.querySelector("script"),w=C.querySelector("#"+m);w.innerHTML="";var r=null,d=null,l=null,c=null,h=o.getBoundingClientRect(),u=e.height||null;u=u.includes("px")?parseFloat(u.replace("px","")):0;var g=h.top+window.scrollY,f=h.bottom+window.scrollY;switch(i){case"beforebegin":r=g-u,d=g,l=h.left,c=h.right;break;case"beforeend":r=f-u,d=f,l=h.left,c=h.right;break;case"afterbegin":r=g,d=g+u,l=h.left,c=h.right;break;case"afterend":r=f,d=f+u,l=h.left,c=h.right}var p=`\n                    <div class="an-injected" data-estimated-y-top="${r}" data-estimated-y-bottom="${d}" data-estimated-x-left="${l}" data-estimated-x-right="${c}">\n                        ${C.innerHTML}\n                    </div>\n                `;if(o.insertAdjacentHTML(i,p),y){let e=document.createElement("script");e.innerHTML=y.innerHTML,w=document.getElementById(m),w&&w.appendChild(e)}o.classList.add("adsninja-injected-repeatable-ad-"+i);let b={...t};return 1!==t.zone.positionType&&(b.divId=m),b}return null};__getPrintableNode=function(e,t){return e=this.__getPrintableNodeCheckingParentsExceptions(e),e=this.__getPrintableNodeCheckingAfterExceptions(e,t)};__getPrintableNodeCheckingParentsExceptions=function(e){let t=e;if(""!==this.noRepeatableAdsInsideQueryString)for(;t.parentNode&&"#document"!==t.parentNode.nodeName;){if(t.parentNode.matches(this.noRepeatableAdsInsideQueryString))return this.__getPrintableNodeCheckingParentsExceptions(t.parentNode);t=t.parentNode}return e};__getPrintableNodeCheckingAfterExceptions=function(e,t){let n=e;if(null===n)return null;if(""!==this.noRepeatableAdsAfterQueryString)if(t){if(n.matches(this.noRepeatableAdsAfterQueryString))return this.__getPrintableNodeCheckingAfterExceptions(n.previousElementSibling,t)}else if(n.previousElementSibling&&n.previousElementSibling.matches(this.noRepeatableAdsAfterQueryString))return this.__getPrintableNodeCheckingAfterExceptions(n.previousElementSibling,t);return n};__getZoneElement=function(e){if(!e||!e.type||!e.identifier)return;let t=null;switch(e.type){default:case"query":this.__isQuerySelectorValid(e.identifier)?t=document.querySelector(e.identifier):console.warn("ADS INJECTOR: Invalid zone container identifier : "+e.identifier);break;case"class":try{t=document.getElementsByClassName(e.identifier)[0]}catch(t){console.warn("ADS INJECTOR: Invalid zone container identifier : "+e.identifier)}e.first;break;case"tag":try{t=document.getElementsByTagName(e.identifier)[0]}catch(t){console.warn("ADS INJECTOR: Invalid zone container identifier : "+e.identifier)}e.first;break;case"id":try{t=document.getElementById(e.identifier)}catch(t){console.warn("ADS INJECTOR: Invalid zone container identifier : "+e.identifier)}}return t};__getZoneHeaders=function(e){let t=this.customHeaders[e]||null;if(!t)return"";let n=t.header.replace(/<script>/g,"");return n=n.replace(/<\/script>/g,""),n};__generateHtmlByZone=function(e){let t=this.adsConfigs.adContentPerZone[e]||null;if(!t)return;let n="",i=t.additionalClasses||"";i+=" an-injector-zone ",t.isValstreamVideo?i+=" adsninja-valstream an-zone-vp ":i+=" an-zone-d ",t.doNotUseSpace&&(i+=" adsninja-ad-zone-not-using-space ",n+="height: 0; border: none; padding: 0; margin: 0; position: fixed; bottom: 0px; z-index: "+(t.floatingPriority||2147482647)),(t.adElementId.includes("connectedBelowAd")||t.isConnectedBelowAd)&&(i+=" connectedBelowAd "),t.useinterscrollerAnimation&&(i+=" interscroller-wrapper "),i.includes("an-can-float")&&!t.isValstreamVideo&&(i+=" an-constrained ");let a=this.configs.disable_remove_ads_button??!1,o=this.configs.remove_ads_url??"/premium/?ref=ad_removal",s="";!(a||t.hasFloatingOptions||t.hasVideoOptions||t.isValstreamVideo||"footer"===t.zoneGroupName&&("footer"!==t.zoneGroupName||"footer"!==t.zoneName)||"header"===t.zoneGroupName)&&(s=`<a class='an-btn an-btn-hide-me' target='_blank' href='${o}' style='visibility: hidden'><span class='an-btn-icon an-btn-icon-close'>&#x2715</span> Remove Ads</a>`);let r="";if(t.hasOwnProperty("dataAttributes")&&t.dataAttributes)for(let e in t.dataAttributes)r+=`data-${e}="${t.dataAttributes[e]}" `;return'\x3c!-- Zone: "'+e+'" --\x3e<div class="adsninja-ad-zone an-zone '+i+t.useStickySlideAnimation+'" id="adsninja-ad-zone-'+t.adElementId+'" style="'+n+'" '+r+"> "+s+t.content+"</div>"};__validateConfig=function(){return this.validation=!0,this.configs?this.configs.api_parameters?this.configs.ad_setup?this.configs.ad_setup.homepage?this.configs.ad_setup.default?this.configs.zones?(this.__validateZones(),this.validation):(this.validation=!1,void this.validation_errors.push("Configurations are missing zones")):(this.validation=!1,void this.validation_errors.push("Default ad setup config is missing")):(this.validation=!1,void this.validation_errors.push("Homepage ad setup config is missing")):(this.validation=!1,void this.validation_errors.push("Configurations are missing ad setup")):(this.validation=!1,void this.validation_errors.push("Api parameters are missing")):(this.validation=!1,void this.validation_errors.push("Configurations are missing"))};__initAdsNinja=function(){if(!this.adsConfigs)return;document.body.classList.add("an-injector-site"),window.brandName=this.adsConfigs.siteConfig.brand.shortName,this.adsConfigs.logData.hasOwnProperty("winningAdUnitId")&&(this.adsConfigs.logData.winningAdUnitIds=this.adsConfigs.logData.winningAdUnitId,delete this.adsConfigs.logData.winningAdUnitId),this.adsConfigs.logData.clientData.hasOwnProperty("networkCategory")&&(this.adsConfigs.logData.clientData.networkCategory="undefined"!=typeof VALNET_GLOBAL_NETWORKCATEGORY?VALNET_GLOBAL_NETWORKCATEGORY:"all");var e=this.adsConfigs.logData||{};e&&e.hasOwnProperty("clientData")&&(e.clientData.url=window.location.protocol+"//"+window.location.hostname+"/"+window.location.pathname.replace(/(^\/+|\/+$)/g,"")+"/","/"===window.location.pathname&&(e.clientData.url=window.location.protocol+"//"+window.location.hostname+"/"),"FX"!==window.brandName&&"POLY"!==window.brandName||(e.clientData.url=window.location.protocol+"//"+window.location.hostname+window.location.pathname));let t={siteConfig:this.adsConfigs.siteConfig?this.adsConfigs.siteConfig:null,failSafeTimeout:this.adsConfigs.siteConfig.globFailSafeTimeout??this.adsConfigs.siteConfig.globalFailSafeTimeout??this.adsConfigs.siteConfig.failSafeTimeout??3500,cmpTimeout:this.adsConfigs.siteConfig.cmpTimeout??4e3,prebidTimeout:this.adsConfigs.siteConfig.prebidTimeout??3e3,amazonTimeout:this.adsConfigs.siteConfig.amazonTimeout??3e3,isEuTraffic:this.__isEuTraffic(),usingVideoPlayer:!0,prebidServerAliasData:this.adsConfigs.prebidServerAliasData,adCapabilities:this.adsConfigs.adCapabilities,adsData:this.__getAdsData(),railAds:[],modeAds:1,deviceType:this.__getAPIParams().data.deviceType,adCountData:{articleNumber:0,injectionTypeCounts:[],pageNumber:0},allowedDomains:this.__getAllowedDomains(),videoList:this.adsConfigs.videoList,logData:this.adsConfigs.logData,dynamicallyInjectedAdZones:[],dynamicInjectionRefreshAdZones:this.__getDynamicInjectionRefreshAdZones(),adUnitBidderConfigs:this.adsConfigs.adUnitBidderConfigsPrebid,sspsThatCouldHaveOwnCloseButton:this.adsConfigs.sspsThatCouldHaveOwnCloseButton,eventTrackingDictionary:this.adsConfigs.eventTrackingDictionary,adBehaviours:this.adsConfigs.adBehaviours,pageLevelDefinition:this.adsConfigs.pageLevelDefinition||{},consentContext:this.__getConsentContext(),consentNeeded:this.__getConsentNeeded(),connectionConfig:this.adsConfigs.connectionConfig,boostedUrlData:this.boostedUrlData,pageGamId:this.gamId,floors:this.adsConfigs.floors||null,directDealsMapping:"object"==typeof this.adsConfigs.directDealsMapping&&0!==Object.keys(this.adsConfigs.directDealsMapping).length?this.adsConfigs.directDealsMapping:{},apiVersion:this.adsConfigs.apiVersion||"v1",injectionConfig:this.configs};console.log("ADS INJECTOR --- DATA SENT TO ADSNINJA CLIENT",t);var n=null,i=this.adsConfigs.siteConfig?this.adsConfigs.siteConfig:null;null!==i&&(n=i.sentinelEnabled??!1),(!t.pageLevelDefinition||"object"==typeof t.pageLevelDefinition&&0===Object.keys(t.pageLevelDefinition).length)&&(t.pageLevelDefinition.engagementContainer="body");var a={an_sn_e:n,mode_A:1,pageLevelDefinition:window.pageLevelDefinitionObj||t.pageLevelDefinition,infiniteScrollEvent:"adsNinjaSentinelInfiniteScroll"};window.an_sn=window.an_sn||{},window.an_sn.queue=window.an_sn.queue||[],window.an_sn.queue.unshift(function(){window.an_sn.init(a,"init")}),window.adsNinja=window.adsNinja||{},window.adsNinja.queue=window.adsNinja.queue||[],window.adsNinja.isInjectorInjected=!0,window.adsNinja.queue.unshift(function(){window.adsNinja.run(t)});let o=[];this.adsConfigs.splitMarkersForIgnoreBlock.forEach(e=>{let t=/class\s*=\s*["']?([^"'\s>]*)([^"'\s>]*)/i.exec(e.opener);t&&o.push(t[1].split(/\s+/));let n=/id\s*=\s*["']?([^"'\s>]*)([^"'\s>]*)/i.exec(e.opener);n&&o.push(n[1].split(/\s+/))}),window.toIgnore=o;var s=this,r=function(){window.adsNinja.queue.push(function(){window.adsNinja.queue.push(function(){var e="",t=[];s.configs&&s.configs.hasOwnProperty("secondary")&&s.configs.secondary&&s.configs.secondary.hasOwnProperty("rail")&&s.configs.secondary.rail&&Array.isArray(s.configs.secondary.rail)&&(s.configs.secondary.rail.forEach(function(e){s.__isQuerySelectorValid(e)?t.push(e):console.warn("ADS INJECTOR: Invalid secondary rail identifier : "+e)}),t.length>0&&(e=t.join(", "),(t=document.querySelectorAll(e)).forEach(function(e){window.adsNinja.monetizeRail(e,{name:"rail",groupName:"sidebar"},{ignore:window.toIgnore,backupZoneInfo:{name:"rail short",groupName:"sidebar"}})})))}),window.adsNinja.queue.push(function(){var e="";s.configs&&s.configs.hasOwnProperty("secondary")&&s.configs.secondary&&s.configs.secondary.hasOwnProperty("table")&&s.configs.secondary.table&&Array.isArray(s.configs.secondary.table)?e=s.configs.secondary.table.join(", "):(e="#article-body > div.content-block-regular > div.table-container > table",e+=", #article-body > div.content-block-regular > #article-hidden-content > div.table-container > table"),document.querySelectorAll(e).forEach(function(e){window.adsNinja.monetizeTable(e,{name:"character count repeatable secondary",groupName:"content"},{ignore:window.toIgnore})})}),window.adsNinja.queue.push(function(){var e="";s.configs&&s.configs.hasOwnProperty("secondary")&&s.configs.secondary&&s.configs.secondary.hasOwnProperty("list")&&s.configs.secondary.list&&Array.isArray(s.configs.secondary.list)?e=s.configs.secondary.list.join(", "):(e="#article-body > div.content-block-regular > ul",e+=", #article-body > div.content-block-regular > ol",e+=", #article-body > div.content-block-regular > div.directory-container > ul",e+=", #article-body > div.content-block-regular > div.directory-container > ol",e+=", #article-body > div.content-block-regular > #article-hidden-content > ul",e+=", #article-body > div.content-block-regular > #article-hidden-content > ol",e+=", #article-body > div.content-block-regular > #article-hidden-content > div.directory-container > ul",e+=", #article-body > div.content-block-regular > #article-hidden-content > div.directory-container > ol"),document.querySelectorAll(e).forEach(function(e){window.adsNinja.monetizeList(e,{name:"character count repeatable secondary",groupName:"content"},{ignore:window.toIgnore})})})})};"complete"!==document.readyState?document.addEventListener("readystatechange",function(e){"complete"===e.target.readyState&&r()}):r()};__validateZones=function(){this.__getZones().forEach(e=>e.name?e.container?void 0:(this.validation=!1,void this.validation_errors.push(e.name+" is missing it's container")):(this.validation=!1,void this.validation_errors.push("A zone is missing it's ZoneName")))};__getAdsData=function(){return this.adsData};__httpBuildQuery=function(e){const t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{if("object"==typeof n&&null!==n){const i=JSON.stringify(n);t.append(e,i)}else t.append(e,n)}),t.toString()};__isEuTraffic=function(){return this.__getAPIParams().data.geo,Object.keys(this.euTraffic).includes(this.country)||Object.values(this.euTraffic).includes(this.country)};__getAllowedDomains=function(){return(this.adsConfigs?.siteConfig?.allowedDomains??"").replace(" ","").split(",")};__getDynamicInjectionRefreshAdZones=function(){let e={};for(let t in this.adsConfigs.dynamicInjectionRefreshAdZones){let n=this.adsConfigs.dynamicInjectionRefreshAdZones[t];n.headerTemplate&&n.contentTemplate&&""!==n.headerTemplate&&""!==n.contentTemplate&&(e[t]=n)}return e};__shouldIncludeCmp=function(){return!!(this.country&&this.regionsToIncludeCMP.hasOwnProperty(this.country)&&(0===Object.keys(this.regionsToIncludeCMP[this.country].states).length||this.region&&this.regionsToIncludeCMP[this.country].states.hasOwnProperty(this.region)))};__getConsentContext=function(){return this.__shouldIncludeCmp()?this.regionsToIncludeCMP[this.country].consentContext:null};__getConsentNeeded=function(){return!!this.__shouldIncludeCmp()&&this.regionsToIncludeCMP[this.country].consentNeeded};__addContentToHead=function(e){if(!e)return;let t=document.createElement("div");t.innerHTML=e,Array.from(t.children).forEach(e=>{if("SCRIPT"===e.tagName){let t=document.createElement("script");t.innerHTML=e.innerHTML,void 0!==e.getAttribute("src")&&null!==e.getAttribute("src")&&(t.src=e.getAttribute("src")),e=t}document.head.appendChild(e)})};__addContentToFooter=function(e){if(!e)return;let t=document.createElement("div");t.innerHTML=e,Array.from(t.children).forEach(e=>{if("SCRIPT"===e.tagName){let t=document.createElement("script");t.innerHTML=e.innerHTML,void 0!==e.getAttribute("src")&&null!==e.getAttribute("src")&&(t.src=e.getAttribute("src")),e=t}document.body.appendChild(e)})};__waitForDOMReady=async function(){return-1!==location.hostname.indexOf("hotcars.com")?new Promise(e=>{"complete"===document.readyState?e():document.addEventListener("readystatechange",function(t){"complete"===t.target.readyState&&e()})}):new Promise(e=>{"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)})};__determineSource=function(){var e=document.referrer;if(e.indexOf(".google.")>-1)return"organic";if(e.indexOf(".facebook.")>-1)return"FB-P";if(URLSearchParams){var t=new URLSearchParams(window.location.search).get("utm_source");return t?(t=t.toLowerCase()).indexOf("organic")>-1?"organic":t.indexOf("syndication")>-1?"syndication":t.indexOf("fb-")>-1||t.indexOf("facebook")>-1?"FB-P":"balance":"organic"}return"organic"}},void 0!==window.AdsInjectorConfig&&(window.ads_injector.setConfigs(window.AdsInjectorConfig),window.ads_injector.init());
//# sourceMappingURL=ads_injector-32ff54a213aad8ee9cd8.js.map