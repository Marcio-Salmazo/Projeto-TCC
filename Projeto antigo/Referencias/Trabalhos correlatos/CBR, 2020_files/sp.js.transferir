function senp1(){this.plUrl="senp.png";this.sessionDuration=30*60*1000;this.lifetimeDuration=10*365*24*60*60*1000;this.debounceResetTimer=null;this.connectionSpeed=this.getConnectionSpeed();this.maxEngagedDepth=0;this.engagedSecondsStartTime=Date.now();this.enableHumanDetection=!1;this.humanConfirmed=!1;this.humanPageLoadTs=performance.now();this.humanHasMouse=!1;this.humanHasScroll=!1;this.humanTyped=!1;this.syntheticEventsDetected=!1;this.humanFirstMouseDelay=null;this.humanFirstScrollDelay=null;this.mouseTimingEntropy=0;this.mouseAngleEntropy=0;this.scrollVelocityEntropy=0;this.audioEntropy=0;this.performanceJitter=0;this.gpuTrusted=!1;this.lastMouseTime=null;this.lastMouseX=null;this.lastMouseY=null;this.lastScrollY=null;this.lastScrollTs=null;this.humanFocusChanges=0;this.uuid=this.generateUUID();var self=this;this.isSampled=!0;var sentinelObject=this.extractKeyValue("config");var propertyId=sentinelObject.propertyId;var humanDetectionProperties=['www.cbr.com','627EDB','www.screenrant.com'];var inactivePropertyReferences=["315F5F"];if(inactivePropertyReferences.includes(propertyId)){this.isSampled=!0}else{var sampleRate=1;this.executeWithProbability(sampleRate,function(){self.isSampled=!1;if(humanDetectionProperties.includes(propertyId)){self.enableHumanDetection=!0}})}
this.sendPings=!1;this.executeWithProbability(0.01,function(){self.sendPings=!0});this.utmDataCookieName="sentinelbi_utmData";var timestamp=this.extractKeyValue("initTimestamp")||Date.now();this.sendPxl(timestamp,"pageview");this.initHumanDetection()};senp1.prototype.initHumanDetection=function(){if(!this.enableHumanDetection)return;const self=this;document.addEventListener("mousemove",function(e){if(!e.isTrusted)self.syntheticEventsDetected=!0;const now=performance.now();if(!self.humanHasMouse){self.humanHasMouse=!0;self.humanFirstMouseDelay=now-self.humanPageLoadTs}
if(self.lastMouseTime!==null){const dt=now-self.lastMouseTime;self.mouseTimingEntropy+=Math.min(Math.abs(dt-16),10)}
self.lastMouseTime=now;if(self.lastMouseX!==null){const dx=e.clientX-self.lastMouseX;const dy=e.clientY-self.lastMouseY;if(dx!==0||dy!==0){const angle=Math.atan2(dy,dx)*180/Math.PI;const entropyAngle=Math.abs(angle%45);self.mouseAngleEntropy+=Math.min(entropyAngle,10)}}
self.lastMouseX=e.clientX;self.lastMouseY=e.clientY;self.tryConfirmHuman()});window.addEventListener("scroll",function(){const now=performance.now();const y=window.scrollY;if(!self.humanHasScroll){self.humanHasScroll=!0;self.humanFirstScrollDelay=now-self.humanPageLoadTs}
if(self.lastScrollY!==null){const dy=y-self.lastScrollY;const dt=now-self.lastScrollTs;const velocity=dy/dt;self.scrollVelocityEntropy+=Math.abs(velocity)*2}
self.lastScrollY=y;self.lastScrollTs=now;self.tryConfirmHuman()});document.addEventListener("keydown",function(e){if(!e.isTrusted)self.syntheticEventsDetected=!0;self.humanTyped=!0;self.tryConfirmHuman()});window.addEventListener("blur",()=>{self.humanFocusChanges++;self.tryConfirmHuman()});window.addEventListener("focus",()=>{self.humanFocusChanges++;self.tryConfirmHuman()});setTimeout(()=>{const start=performance.now();setTimeout(()=>{self.performanceJitter=Math.abs(performance.now()-start-25);self.tryConfirmHuman()},25)},10);try{const canvas=document.createElement("canvas");const gl=canvas.getContext("webgl");if(gl){const dbg=gl.getExtension("WEBGL_debug_renderer_info");if(dbg){const vendor=gl.getParameter(dbg.UNMASKED_VENDOR_WEBGL);const renderer=gl.getParameter(dbg.UNMASKED_RENDERER_WEBGL);self.gpuTrusted=vendor&&renderer&&!/swiftshader|mesa|google|llvmpipe/i.test(renderer)}}}catch(e){}
try{const AC=window.AudioContext||window.webkitAudioContext;const ac=new AC();const osc=ac.createOscillator();const analyser=ac.createAnalyser();osc.connect(analyser);osc.start(0);const freq=new Float32Array(analyser.frequencyBinCount);analyser.getFloatFrequencyData(freq);self.audioEntropy=Math.abs(freq[10]%10)}catch(e){}
setTimeout(()=>self.tryConfirmHuman(),3000)};senp1.prototype.tryConfirmHuman=function(){if(!this.enableHumanDetection)return;if(this.humanConfirmed)return;const interacted=this.humanHasMouse||this.humanHasScroll;let score=0;if(this.mouseTimingEntropy>5)score+=10;if(this.mouseAngleEntropy>8)score+=10;if(this.scrollVelocityEntropy>5)score+=10;if(this.humanFirstMouseDelay===null||this.humanFirstMouseDelay>=40)
score+=10;if(this.humanFirstScrollDelay===null||this.humanFirstScrollDelay>=120)
score+=10;if(this.humanTyped)score+=20;if(this.humanFocusChanges>=1)score+=10;if(this.gpuTrusted)score+=10;else score-=10;if(this.audioEntropy>=1)score+=5;if(this.performanceJitter>=1)score+=5;if(this.syntheticEventsDetected)score-=20;const HUMAN_SCORE_THRESHOLD=30;if(interacted&&score>=HUMAN_SCORE_THRESHOLD){this.humanConfirmed=!0;this.sendPxl(Date.now(),"ishc",1)}};senp1.prototype.sendEngagementData=function(initiator){if(!this.sentEngagement){this.sentEngagement=!0;var timestamp=Date.now();var delta=timestamp-this.engagedSecondsStartTime;var engagedSeconds=Math.floor(delta/1000);if(engagedSeconds>3600){engagedSeconds=3600}
let engagedDepth=Math.ceil(this.maxEngagedDepth);if(engagedDepth>100){engagedDepth=100}
var sentinelObject=this.extractKeyValue("config");this.sendPxl(timestamp,"engagement",engagedSeconds+','+engagedDepth,'beacon')}};senp1.prototype.sendPxl=function(timestamp,type,typeValue='',sendMethod=''){var sentinelObject=this.extractKeyValue("config");if(!sentinelObject.accountName||!sentinelObject.propertyId){this.logError("accountName and propertyId are required");return}
if(this.isSampled){this.logError("pixel sampled");return}
var account=sentinelObject.accountName;var propertyId=sentinelObject.propertyId;if(account=='valnet'){account='valnetv3'}
var url="https://"+account+".sentinelpro.com/"+propertyId+"/"+this.plUrl;let params=new URLSearchParams();params.append("time",timestamp);params.append("permalink",window.location.pathname);params.append("url",window.location.href);var referrer=document.referrer;if(referrer){params.append("referrer",referrer)}
if(this.connectionSpeed){params.append("connSpeed",this.connectionSpeed)}
if(sentinelObject){var dimensions=sentinelObject.dimensions;if(dimensions){params.append("dimensions",JSON.stringify(dimensions))}
var userDimensions=sentinelObject.userDimensions;if(userDimensions){params.append("userDimensions",JSON.stringify(userDimensions))}
var internalDimensions=sentinelObject.internalDimensions;if(internalDimensions){params.append("internalDimensions",JSON.stringify(internalDimensions))}}
this.setupUtmDataCookie(this.utmDataCookieName);var utmCookie=this.getCookieValue(this.utmDataCookieName);if(utmCookie){utmCookie=JSON.parse(decodeURIComponent(utmCookie));if("utm_campaign" in utmCookie){params.append("utm_campaign",utmCookie.utm_campaign)}
if("utm_medium" in utmCookie){params.append("utm_medium",utmCookie.utm_medium)}
if("utm_source" in utmCookie){params.append("utm_source",utmCookie.utm_source)}}
params.append("type",type);params.append("typeValue",typeValue);params.append("uuid",this.uuid);if(this.sendPings){params.append("isPing",1)}
if(sendMethod=='beacon'){navigator.sendBeacon(`${url}?${params.toString()}`)}else{var xhttp=new XMLHttpRequest();xhttp.open("GET",`${url}?${params.toString()}`,!0);xhttp.send()}
if(type==='pageview'&&sentinelObject.accountName==='valnet'){if(sentinelObject.propertyId==='www.xda-developers.com'){const url2="https://c1.sentinelpro.com/D5A670/senp.css";const link=document.createElement("link");link.rel="stylesheet";link.href=`${url2}?${params.toString()}`;document.head.appendChild(link)}
if(sentinelObject.propertyId==='www.thesportster.com'){const url3="https://i1.sentinelpro.com/8BCB85/senp.svg";(()=>{const selector='#website-footer .valnet-content';const position='after';const timeout=6000;const imgSrc=`${url3}?${params.toString()}`
const markup=`
                    <div style="display:block;height:1.25rem;">
                        <img class="powered-logo" src=${imgSrc} alt="Powered by SentinelPro" style="height:100%;width:auto;" />
                    </div>
                    <style>
                        @media (prefers-color-scheme: dark) {
                            .powered-logo {
                                filter: invert(1);
                            }
                        }
                    </style>
                `;function waitForElement(sel,ms){return new Promise(resolve=>{const found=document.querySelector(sel);if(found)return resolve(found);let t;const observer=new MutationObserver(()=>{const el=document.querySelector(sel);if(el){clearTimeout(t);observer.disconnect();resolve(el)}});observer.observe(document.documentElement,{childList:!0,subtree:!0});t=setTimeout(()=>{observer.disconnect();resolve(null)},ms)})}
function injectElement(target,html,where){target.insertAdjacentHTML(where==='before'?'afterbegin':'beforeend',html)}
async function run(){let target=document.querySelector(selector);if(!target)target=await waitForElement(selector,timeout);if(!target)return;injectElement(target,markup,position)}
if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>{run()},{once:!0})}else{run()}})()}}};senp1.prototype.sendEvent=function(category,type,typeValue=''){if(this.isNullOrEmptyOrUndefined(category)||this.isNullOrEmptyOrUndefined(type)){this.logError("Event category and type are required to send an event");return}
var sentinelObject=this.extractKeyValue("config");if(!sentinelObject.accountName||!sentinelObject.propertyId){this.logError("accountName and propertyId are required");return}
if(this.isSampled){this.logError("pixel sampled");return}
var account=sentinelObject.accountName;var propertyId=sentinelObject.propertyId;if(account=='valnet'){account='valnetv3'}
var url="https://"+account+".sentinelpro.com/"+propertyId+"/"+this.plUrl;let params=new URLSearchParams();params.append("time",Date.now());params.append("permalink",window.location.pathname);params.append("url",window.location.href);var referrer=document.referrer;if(referrer){params.append("referrer",referrer)}
if(this.connectionSpeed){params.append("connSpeed",this.connectionSpeed)}
if(sentinelObject){var dimensions=sentinelObject.dimensions;if(dimensions){params.append("dimensions",JSON.stringify(dimensions))}
var userDimensions=sentinelObject.userDimensions;if(userDimensions){params.append("userDimensions",JSON.stringify(userDimensions))}}
var utmCookie=this.getCookieValue(this.utmDataCookieName);if(utmCookie){utmCookie=JSON.parse(decodeURIComponent(utmCookie));if("utm_campaign" in utmCookie){params.append("utm_campaign",utmCookie.utm_campaign)}
if("utm_medium" in utmCookie){params.append("utm_medium",utmCookie.utm_medium)}
if("utm_source" in utmCookie){params.append("utm_source",utmCookie.utm_source)}}
params.append("category",category);params.append("type",type);params.append("typeValue",typeValue);params.append("uuid",this.uuid);params.append("isEvent",1);var xhttp=new XMLHttpRequest();xhttp.open("GET",`${url}?${params.toString()}`,!0);xhttp.send()};senp1.prototype.getConnectionSpeed=function(){var connectionSpeed=null;if(navigator.connection){connectionSpeed=navigator.connection.downlink}
return connectionSpeed};senp1.prototype.sendFtPl=function(){if(this.sendPings){var timestamp=this.extractKeyValue("footerTimestamp")||Date.now();this.sendPxl(timestamp,"footerPing",timestamp)}};senp1.prototype.checkForGA=function(){var self=this;setTimeout(function(){self.checkForGATest()},3000)};senp1.prototype.checkForGATest=function(){if(typeof window.gtag==='function'){if(window.dataLayer){let gtmDOM=window.dataLayer.some((entry)=>{if('event' in entry){return entry['event']==='gtm.dom'}});if(!gtmDOM){var timestamp=Date.now();this.sendPxl(timestamp,"isGATrackerBlocked",1)}}else{var timestamp=Date.now();this.sendPxl(timestamp,"isGATrackerBlocked",1)}}};senp1.prototype.executeWithProbability=function(probability,callback){if(Math.random()<=probability){callback()}};senp1.prototype.injectFooterJs=function(){var footerJs=document.createElement('script');footerJs.textContent=`if(window.websiteSentinel) {

        window.websiteSentinel.sendFtPl();
        window.websiteSentinel.trackUserMetrics();
        window.websiteSentinel.checkForAblc();
    }

    //Check for GA on pageLoad after GA has tried to load
    window.onload = function() {

        if (window.websiteSentinel && !0) {

            window.websiteSentinel.checkForGA();
        }else {
        
            window.websiteSentinel.logError('Skipped blc check')
        }
    };`;if(!this.extractKeyValue("footerTimestamp")){window.addEventListener('DOMContentLoaded',()=>{this.appendToFooter(footerJs)})}else{this.appendToFooter(footerJs)}};senp1.prototype.setupUtmDataCookie=function(name){let utmData=this.getUTMParamsFromUrl();this.setCookie(name,utmData,this.lifetimeDuration)};senp1.prototype.setupCookies=function(){var currentSession=this.checkSessionCookie();if(currentSession===null){this.createSessionCookie()}
document.addEventListener("mousemove",()=>{this.debouncedResetTimer()});document.addEventListener("keypress",()=>{this.debouncedResetTimer()})};senp1.prototype.createSessionCookie=function(){var sessionId=this.generateSessionId();var active=new Date().toISOString();this.setCookie("sentinelbi_session",{session_id:sessionId,last_active:active},this.sessionDuration);return sessionId};senp1.prototype.generateSessionId=function(){return'sess-'+Math.random().toString(36).substr(2,9)+'-'+new Date().getTime()};senp1.prototype.debouncedResetTimer=function(){clearTimeout(this.debounceResetTimer);this.debounceResetTimer=setTimeout(()=>{this.resetSessionTimer()},500)};senp1.prototype.resetSessionTimer=function(){var currentSession=this.checkSessionCookie();if(currentSession===null){this.createSessionCookie()}else{const lastActive=new Date(currentSession.last_active).getTime();const currentTime=new Date().getTime();var sessionId=this.getCookieValueByKey("sentinelbi_session","session_id");var active=new Date().toISOString();if((currentTime-lastActive)>this.sessionDuration){sessionId=this.generateSessionId()}
this.setCookie("sentinelbi_session",{session_id:sessionId,last_active:active},this.sessionDuration)}};senp1.prototype.checkSessionCookie=function(){var sessionCookie=this.getCookieValue("sentinelbi_session");if(sessionCookie!==null){return JSON.parse(decodeURIComponent(sessionCookie))}
return null};senp1.prototype.setCookie=function(name,sessionObject,msToExpire){if(typeof sessionObject!=='object'||sessionObject===null){return}
const value=encodeURIComponent(JSON.stringify(sessionObject));const expires=new Date();expires.setTime(expires.getTime()+msToExpire);document.cookie=`${name}=${value}; expires=${expires.toUTCString()}; path=/; SameSite=Strict; Secure`};senp1.prototype.getCookieValue=function(name){var cookies=document.cookie.split("; ");for(let cookie of cookies){var[key,value]=cookie.split("=");if(key===name)return decodeURIComponent(value);}
return null};senp1.prototype.getCookieValueByKey=function(name,key){var cookie=this.getCookieValue(name);if(!cookie){return null}
var parsedObject=JSON.parse(decodeURIComponent(cookie));return parsedObject[key]!==undefined?parsedObject[key]:null};senp1.prototype.appendToFooter=function(script){var footer=document.querySelectorAll('footer')[document.querySelectorAll('footer').length-1];if(footer){footer.appendChild(script)}else{document.body.appendChild(script)}};senp1.prototype.trackUserMetrics=function(){this.maxEngagedDepth=0;this.engagedSecondsStartTime=Date.now();let sentinelObject=this.extractKeyValue("config");if(sentinelObject.customTrackingContainer===undefined||(sentinelObject.customTrackingContainer==='body'||document.querySelector(sentinelObject.customTrackingContainer)===null)){element=document.body}else{element=document.querySelector(sentinelObject.customTrackingContainer)}
let elementStartPos=element.getBoundingClientRect().top+document.documentElement.scrollTop;window.addEventListener("scroll",()=>{let scrolled=window.scrollY+window.innerHeight;var scrolledPos=(scrolled/(element.offsetHeight-elementStartPos))*100;if(scrolledPos>this.maxEngagedDepth&&this.maxEngagedDepth<100){this.maxEngagedDepth=scrolledPos}});window.addEventListener('beforeunload',function(){window.websiteSentinel.sendEngagementData('beforeunload')});window.addEventListener('pagehide',function(){window.websiteSentinel.sendEngagementData('pagehide')});window.addEventListener('visibilitychange',function(){if('visible'===document.visibilityState){return}
window.websiteSentinel.sendEngagementData('visibilitychange')});setTimeout(function(){window.websiteSentinel.sendEngagementData('timer')},3600000)};senp1.prototype.checkForAblc=function(){if(window.localStorage&&window.localStorage.getItem("iablc_key")&&localStorage.getItem('iablc_key')==="true"){var timestamp=Date.now();this.sendPxl(timestamp,"iablc",1)}else{window.addEventListener('iablc_event',function(e){if(e.detail.iablc_key){var timestamp=Date.now();this.sendPxl(timestamp,"iablc",1)}})}};senp1.prototype.getUTMParamsFromUrl=function(){const currentUrl=window.location.href;const urlParams=new URLSearchParams(new URL(currentUrl).search);const utms=['utm_source','utm_medium','utm_campaign','utm_term','utm_content'];let utmData={};utms.forEach(param=>{if(urlParams.has(param)){utmData[param]=urlParams.get(param)}});return utmData};senp1.prototype.extractKeyValue=function(key){var sentinelData=(!window.sentinelData)?window.sentinel:window.sentinelData;if(!sentinelData||!sentinelData.length){return undefined}
const pair=sentinelData.find(([k,v])=>k===key);return pair?pair[1]:undefined};senp1.prototype.generateUUID=function(){var uuid;if(typeof crypto.randomUUID==='function'){uuid=crypto.randomUUID()}else{function fallbackUUID(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==='x'?r:(r&0x3|0x8);return v.toString(16)})}
uuid=fallbackUUID()}
return uuid};senp1.prototype.isNullOrEmptyOrUndefined=function(value){return value==null||value===""};senp1.prototype.logError=function(message){console.error(`[SentinelBI Error]: ${message}`)};senp1.prototype.spaPageview=function(newDimensions){this.sendEngagementData('spa');this.sentEngagement=!1;this.uuid=this.generateUUID();this.overrideSentinelDimensions(newDimensions);this.sendPxl(Date.now(),"pageview");this.trackUserMetrics()};senp1.prototype.overrideSentinelDimensions=function(newDimensions={}){if(!window.sentinelSetup){console.warn('sentinelSetup is not defined.');return}
window.sentinelData=window.sentinelData||[];window.sentinelSetup.dimensions={...newDimensions};let configFound=!1;for(let i=0;i<window.sentinelData.length;i++){const item=window.sentinelData[i];if(Array.isArray(item)&&item[0]==='config'){window.sentinelData[i][1]=window.sentinelSetup;configFound=!0;break}}
if(!configFound){window.sentinelData.push(['config',window.sentinelSetup])}
if(typeof window.sentinelTrack==='function'){window.sentinelTrack('config',window.sentinelSetup)}};window.senp1=senp1;window.websiteSentinel=new senp1();window.websiteSentinel.injectFooterJs()