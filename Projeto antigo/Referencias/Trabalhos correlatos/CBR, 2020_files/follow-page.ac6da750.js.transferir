(()=>{"use strict";var e={925(e,t,n){n.d(t,{A:()=>c});var i=n(3768);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,a(i.key),i)}}function a(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}const c=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ajaxRequest=!1,this.handleAccountVerificationClick=this.handleAccountVerificationClick.bind(this),this.handleCloseButtonClick=this.handleCloseButtonClick.bind(this)},t=[{key:"hideSuccessVerificationMsg",value:function(){var e=document.getElementById("account-verification-popup-success-msg-new");e&&e.classList.add("is-hidden")}},{key:"hideErrorVerificationMsg",value:function(){var e=document.getElementById("account-verification-popup-error-msg-new");e&&e.classList.add("is-hidden")}},{key:"displaySuccessVerificationMsg",value:function(e){var t=document.getElementById("account-verification-popup-success-msg-new"),n=document.getElementById("accountVerificationPopupCloseButton");e&&(t.firstChild.innerHTML=e),t.classList.remove("is-hidden"),setTimeout(function(){t.classList.add("is-hidden"),n&&n.click()},4e3)}},{key:"displayErrorVerificationMsg",value:function(e){var t=document.getElementById("account-verification-popup-error-msg-new"),n=document.getElementById("accountVerificationPopupCloseButton");e&&(t.firstChild.innerHTML=e),t.classList.remove("is-hidden"),setTimeout(function(){t.classList.add("is-hidden"),n&&n.click()},4e3)}},{key:"handleVerificationResponse",value:function(e){this.hideSuccessVerificationMsg(),this.hideErrorVerificationMsg();var t=e.status,n=e.message;"success"===t?this.displaySuccessVerificationMsg(n):this.displayErrorVerificationMsg(n),this.ajaxRequest=!1}},{key:"handleVerifyAccount",value:function(){var e=this;window.isUserLoggedIn&&(this.ajaxRequest&&this.ajaxRequest.abort(),this.ajaxRequest=new XMLHttpRequest,this.ajaxRequest.open("GET","/verify-email/",!0),this.ajaxRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.ajaxRequest.onreadystatechange=function(){4===e.ajaxRequest.readyState&&e.ajaxRequest.response&&e.handleVerificationResponse(JSON.parse(e.ajaxRequest.response))},this.ajaxRequest.send())}},{key:"injectAccountVerificationPopup",value:function(){var e=document.getElementById("account-verification-popup-container");if(!window.accountVerificationContainerInjected&&!e){var t=window.accountVerificationPopupHtml.trim("&quot;").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/(^"|"$)/g,"").replaceAll("loginForm","loginPopup");document.body.insertAdjacentHTML("beforeend",t),window.accountVerificationContainerInjected=!0}}},{key:"showAccountVerificationPopup",value:function(){this.injectAccountVerificationPopup();var e=document.getElementById("account-verification-popup-container"),t=document.getElementById("account-verification-popup-message");if(t&&(t.innerHTML="Please verify your email address to unlock additional features on your account."),e){var n=e.getAttribute("data-style-path-url"),o="true"===e.getAttribute("data-style-injected");n&&!o?(0,i.tW)(n,function(){e.setAttribute("data-style-injected","true"),e.classList.add("is-visible")}):e.classList.add("is-visible")}this.addAccountVerificationPopupEventListeners()}},{key:"addAccountVerificationPopupEventListeners",value:function(){var e=document.getElementById("accountVerificationPopupCloseButton"),t=document.getElementById("accountVerificationPopupSubmitButton");e&&!e.isAlreadyAttached&&(e.isAlreadyAttached=!0,e.removeEventListener("click",this.handleCloseButtonClick),e.addEventListener("click",this.handleCloseButtonClick)),t&&!t.isAlreadyAttached&&(t.isAlreadyAttached=!0,t.removeEventListener("click",this.handleAccountVerificationClick),t.addEventListener("click",this.handleAccountVerificationClick))}},{key:"handleAccountVerificationClick",value:function(e){return e.preventDefault(),e.stopPropagation(),this.handleVerifyAccount(),!1}},{key:"handleCloseButtonClick",value:function(e){return e.preventDefault(),e.stopPropagation(),document.getElementById("account-verification-popup-container").classList.remove("is-visible"),this.hideSuccessVerificationMsg(),this.hideErrorVerificationMsg(),!1}}],t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}()},3768(e,t,n){function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};o([e]).then(function(){t()})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.allSettled(e.map(function(e){return new Promise(function(t){var n=function(){return t()};if(!e)return n();var i=document.head.querySelector('link[href="'.concat(e,'"]'));if(i)return"complete"===i.readyState||"loaded"===i.readyState?n():(i.addEventListener("load",n),void i.addEventListener("error",n));var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),o.addEventListener("load",n),o.addEventListener("error",n),document.head.appendChild(o)})}))}n.d(t,{tW:()=>i})}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var i=n(925);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=!1;function l(e){return fetch("/follow-submit/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(e)}).then(function(e){if(!e.ok)throw new Error;return e.json()}).then(function(t){return e.pushToTopOfList&&e.listName&&e.idTag&&(document.cookie="".concat(e.listName,"=").concat(e.idTag)),t})}window.handleFollowPage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=window.websiteUser?window.websiteUser:null;if(void 0===e||!e)return!1;var r={mode:"popup",idParent:null,className:"popup",triggeredFrom:"follow",gaEventCategory:"follow",showCloseButton:!0},c={id:e.id,type:e.type,title:e.title,permalink:e.permalink,isFollow:e.value,preference:e.preference,pushToTopOfList:!0,idTag:e.idTag,listName:n};r.valnetLoginAction={apiCallCallback:"window.globalFollowPageAction",apiCallCallbackOptions:c};var u=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"thread",o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(r=a(a({},{mode:"popup",idParent:null,className:"popup",triggeredFrom:"thread",gaEventCategory:"thread",showCloseButton:!0}),r),!e){if(window.dispatchEvent(new CustomEvent("valnet_ui_event:user_not_logged_in")),t){if(!window.ValnetLogin)return console.error("ValnetLogin is not defined."),!1;var l=new ValnetLogin(r);l.showLoginForm(l),o&&(location.hash=n)}return"function"==typeof c&&c(),!1}if(!e.isVerified)return window.dispatchEvent(new CustomEvent("valnet_ui_event:user_not_verified")),t&&(new i.A).showAccountVerificationPopup(),"function"==typeof s&&s(),!1;return!0}(o,!0,"follow",!1,r);if(!u)return!1;c.pushToTopOfList=!1,s&&s.abort(),"0"==c.isFollow&&(c.preference=""),c&&l(c).then(function(e){t&&t(e,c)})},window.globalFollowPageAction=function(e){return l(e)},window.handleDisplayCard=function(){var e=document.querySelectorAll(".w-options-btn.member-interaction.my-follows"),t=function(e){return function(t){e.querySelector(".options-dropdown").classList.toggle("active")}};e.length>0&&e.forEach(function(e){e.removeEventListener("touchend",t(e)),e.addEventListener("touchend",t(e))})},window.markAllAsRead=function(){if(window.isUserLoggedIn){if(window.isUserVerified)s&&s.abort(),(s=new XMLHttpRequest).open("GET","/follow-read-all/",!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){if(4==s.readyState&&s.response){var e=document.getElementById("follow-page-success-msg"),t=document.getElementById("follow-page-error-msg"),n=document.getElementById("read-all");e.classList.add("is-hidden"),t.classList.add("is-hidden");var i=JSON.parse(s.response);if("success"==i.status)e.classList.remove("is-hidden"),setTimeout(function(){e.classList.add("is-hidden")},2e3),document.querySelectorAll(".has-notification").forEach(function(e){e.classList.remove("has-notification")}),document.querySelectorAll(".i-notification:not(.action-bar-link)").forEach(function(e){e.classList.remove("i-notification")}),n.classList.add("is-disabled");else t.classList.remove("is-hidden"),t.firstChild.innerHTML=i.message,setTimeout(function(){t.classList.add("is-hidden")},2e3);s=!1}},s.send();else document.querySelectorAll(".account-verification-popup-container").forEach(function(e){e.classList.add("is-visible")})}else{var e=new ValnetLogin({mode:"popup",idParent:null,className:"popup",triggeredFrom:"follow",gaEventCategory:"follow",showCloseButton:!0});e.showLoginForm(e)}},window.articleOrHubPageSuccessHandler=function(e,t){var n=document.querySelectorAll("[data-is-follow-container][data-id='"+t.id+"']"),i=document.querySelectorAll("[data-is-followed-container][data-id='"+t.id+"']");"1"===t.isFollow?(n.forEach(function(e){e.classList.add("is-hidden")}),i.forEach(function(e){e.classList.remove("is-hidden")})):(i.forEach(function(e){e.classList.add("is-hidden")}),n.forEach(function(e){e.classList.remove("is-hidden")}));var o=e.action.update,r=o.followUserCount,a=o.idItem;r&&document.querySelectorAll(".js-follow-count").forEach(function(e){if(e&&e.hasAttribute("data-profile-follower-id")){var t=e.getAttribute("data-profile-follower-id");t&&t===a&&(e.innerHTML=r)}})},window.handleFollow=function(){var e=document.querySelectorAll('[data-is-follow-choice-button="true"]');e.length>0&&e.forEach(function(e){e.isAttached||(e.addEventListener("click",function(t){if(t.preventDefault(),t.stopPropagation(),window.dispatchEvent(new CustomEvent("sentinel:relay:tracker",{detail:{event:t}})),"function"==typeof window.handleFollowPage){var n=e.closest("[data-list-name]"),i=null;return n&&(i=n.dataset.listName),window.handleFollowPage(e.dataset,window.articleOrHubPageSuccessHandler,i),!1}}),e.classList.remove("is-disabled"),e.isAttached=!0)})};var u=function(){window.handleDisplayCard(),"function"==typeof window.handleFollowPage&&window.handleFollow();var e=document.getElementById("read-all");e&&e.addEventListener("click",function(e){e.preventDefault(),window.markAllAsRead()})};"loading"!==document.readyState?u():document.addEventListener("DOMContentLoaded",function(){u()}),window.overrideAccountVerification=function(){(new i.A).handleVerifyAccount()}})();